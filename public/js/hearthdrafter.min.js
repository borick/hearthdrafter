(function(h){function n(a){var b=this.internal=new r(this);b.loadConfig(a);b.init();(function l(a,b,f){Object.keys(a).forEach(function(g){b[g]=a[g].bind(f);0<Object.keys(a[g]).length&&l(a[g],b[g],f)})})(u,this,this)}function r(a){this.d3=h.d3?h.d3:"undefined"!==typeof require?require("d3"):void 0;this.api=a;this.config=this.getDefaultConfig();this.data={};this.cache={};this.axes={}}function m(a){this.owner=a}function x(a,b){function e(a,b){a.attr("transform",function(a){return"translate("+Math.ceil(b(a)+
u)+", 0)"})}function l(a,b){a.attr("transform",function(a){return"translate(0,"+Math.ceil(b(a))+")"})}function q(a){var b=a[0];a=a[a.length-1];return b<a?[b,a]:[a,b]}function v(a){var b,e=[];if(a.ticks)return a.ticks.apply(a,r);b=a.domain();for(a=Math.ceil(b[0]);a<b[1];a++)e.push(a);0<e.length&&0<e[0]&&e.unshift(e[0]-(e[1]-e[0]));return e}function f(){var a=D.copy(),e;b.isCategory&&(e=D.domain(),a.domain([e[0],e[1]-1]));return a}function g(a){a=n?n(a):a;return"undefined"!==typeof a?a:""}function t(a){if(O)return O;
var b={h:11.5,w:5.5};a.select("text").text(g).each(function(a){var e=this.getBoundingClientRect(),l=g(a);a=e.height;e=l?e.width/l.length:void 0;a&&e&&(b.h=a,b.w=e)}).text("");return O=b}function y(n){n.each(function(){function n(a,e){function l(a,b){f=void 0;for(var q=1;q<b.length;q++)if(" "===b.charAt(q)&&(f=q),v=b.substr(0,q+1),p=T.w*v.length,e<p)return l(a.concat(b.substr(0,f?f:q)),b.slice(f?f+1:q));return a.concat(b)}var q=g(a),v,f,p;if("[object Array]"===Object.prototype.toString.call(q))return q;
if(!e||0>=e)e=Z?95:b.isCategory?Math.ceil(L(V[1])-L(V[0]))-12:110;return l([],q+"")}function r(a,b){var e=T.h;0===b&&(e="left"===h||"right"===h?-(T.h/2*(J[a.index]-1)-3):".71em");return e}function ca(a){a=D(a)+(P?0:u);return Q[0]<a&&a<Q[1]?6:0}var I=y.g=a.select(this),G=this.__chart__||D,L=this.__chart__=f(),V=m?m:v(L),w=I.selectAll(".tick").data(V,L),M=w.enter().insert("g",".domain").attr("class","tick").style("opacity",1E-6),H=w.exit().remove(),x=(b.withoutTransition?w:a.transition(w)).style("opacity",
1),N,R,aa,Q=D.rangeExtent?D.rangeExtent():q(D.range());R=I.selectAll(".domain").data([0]);var C=(R.enter().append("path").attr("class","domain"),b.withoutTransition?R:a.transition(R));M.append("line");M.append("text");var E=M.select("line"),B=x.select("line"),da=M.select("text"),A=x.select("text");b.isCategory?(u=Math.ceil((L(1)-L(0))/2),R=P?0:u,aa=P?u:0):u=R=0;var F,T=t(I.select(".tick")),J=[],I=Math.max(6,0)+3,Z="left"===h||"right"===h,w=w.select("text");F=w.selectAll("tspan").data(function(a,e){var l=
b.tickMultiline?n(a,b.tickWidth):[].concat(g(a));J[e]=l.length;return l.map(function(a){return{index:e,splitted:a}})});F.enter().append("tspan");F.exit().remove();F.text(function(a){return a.splitted});var Y=b.tickTextRotate;switch(h){case "bottom":N=e;E.attr("y2",6);da.attr("y",I);B.attr("x1",R).attr("x2",R).attr("y2",ca);A.attr("x",0).attr("y",Y?11.5-Y/15*2.5*(0<Y?1:-1):I).style("text-anchor",Y?0<Y?"start":"end":"middle").attr("transform",Y?"rotate("+Y+")":"");F.attr("x",0).attr("dy",r).attr("dx",
Y?8*Math.sin(Y/180*Math.PI):0);C.attr("d","M"+Q[0]+","+W+"V0H"+Q[1]+"V"+W);break;case "top":N=e;E.attr("y2",-6);da.attr("y",-I);B.attr("x2",0).attr("y2",-6);A.attr("x",0).attr("y",-I);w.style("text-anchor","middle");F.attr("x",0).attr("dy","0em");C.attr("d","M"+Q[0]+","+-W+"V0H"+Q[1]+"V"+-W);break;case "left":N=l;E.attr("x2",-6);da.attr("x",-I);B.attr("x2",-6).attr("y1",aa).attr("y2",aa);A.attr("x",-I).attr("y",u);w.style("text-anchor","end");F.attr("x",-I).attr("dy",r);C.attr("d","M"+-W+","+Q[0]+
"H0V"+Q[1]+"H"+-W);break;case "right":N=l,E.attr("x2",6),da.attr("x",I),B.attr("x2",6).attr("y2",0),A.attr("x",I).attr("y",0),w.style("text-anchor","start"),F.attr("x",I).attr("dy",r),C.attr("d","M"+W+","+Q[0]+"H0V"+Q[1]+"H"+W)}if(L.rangeBand)var O=L,X=O.rangeBand()/2,G=L=function(a){return O(a)+X};else G.rangeBand?G=L:H.call(N,L);M.call(N,G);x.call(N,L)})}var D=a.scale.linear(),h="bottom",W,m=null,n,r,u=0,G=!0,P;b=b||{};W=b.withOuterTick?6:0;y.scale=function(a){if(!arguments.length)return D;D=a;
return y};y.orient=function(a){if(!arguments.length)return h;h=a in{top:1,right:1,bottom:1,left:1}?a+"":"bottom";return y};y.tickFormat=function(a){if(!arguments.length)return n;n=a;return y};y.tickCentered=function(a){if(!arguments.length)return P;P=a;return y};y.tickOffset=function(){return u};y.tickInterval=function(){var a;b.isCategory?a=2*u:(a=y.g.select("path.domain").node().getTotalLength()-2*W,a/=y.g.selectAll("line").size());return Infinity===a?0:a};y.ticks=function(){if(!arguments.length)return r;
r=arguments;return y};y.tickCulling=function(a){if(!arguments.length)return G;G=a;return y};y.tickValues=function(a){if("function"===typeof a)m=function(){return a(D.domain())};else{if(!arguments.length)return m;m=a}return y};return y}var B={version:"0.4.10"},u,f;B.generate=function(a){return new n(a)};B.chart={fn:n.prototype,internal:{fn:r.prototype,axis:{fn:m.prototype}}};u=B.chart.fn;f=B.chart.internal.fn;f.init=function(){var a=this.config;this.initParams();if(a.data_url)this.convertUrlToData(a.data_url,
a.data_mimeType,a.data_keys,this.initWithData);else if(a.data_json)this.initWithData(this.convertJsonToData(a.data_json,a.data_keys));else if(a.data_rows)this.initWithData(this.convertRowsToData(a.data_rows));else if(a.data_columns)this.initWithData(this.convertColumnsToData(a.data_columns));else throw Error("url or json or rows or columns is required.");};f.initParams=function(){var a=this.d3,b=this.config;this.clipId="c3-"+ +new Date+"-clip";this.clipIdForXAxis=this.clipId+"-xaxis";this.clipIdForYAxis=
this.clipId+"-yaxis";this.clipIdForGrid=this.clipId+"-grid";this.clipIdForSubchart=this.clipId+"-subchart";this.clipPath=this.getClipPath(this.clipId);this.clipPathForXAxis=this.getClipPath(this.clipIdForXAxis);this.clipPathForYAxis=this.getClipPath(this.clipIdForYAxis);this.clipPathForGrid=this.getClipPath(this.clipIdForGrid);this.clipPathForSubchart=this.getClipPath(this.clipIdForSubchart);this.dragStart=null;this.transiting=this.mouseover=this.cancelClick=this.flowing=this.dragging=!1;this.color=
this.generateColor();this.levelColor=this.generateLevelColor();this.dataTimeFormat=b.data_xLocaltime?a.time.format:a.time.format.utc;this.axisTimeFormat=b.axis_x_localtime?a.time.format:a.time.format.utc;this.defaultAxisTimeFormat=this.axisTimeFormat.multi([[".%L",function(a){return a.getMilliseconds()}],[":%S",function(a){return a.getSeconds()}],["%I:%M",function(a){return a.getMinutes()}],["%I %p",function(a){return a.getHours()}],["%-m/%-d",function(a){return a.getDay()&&1!==a.getDate()}],["%-m/%-d",
function(a){return 1!==a.getDate()}],["%-m/%-d",function(a){return a.getMonth()}],["%Y/%-m/%-d",function(){return!0}]]);this.hiddenTargetIds=[];this.hiddenLegendIds=[];this.focusedTargetIds=[];this.defocusedTargetIds=[];this.xOrient=b.axis_rotated?"left":"bottom";this.yOrient=b.axis_rotated?b.axis_y_inner?"top":"bottom":b.axis_y_inner?"right":"left";this.y2Orient=b.axis_rotated?b.axis_y2_inner?"bottom":"top":b.axis_y2_inner?"left":"right";this.subXOrient=b.axis_rotated?"left":"bottom";this.isLegendRight=
"right"===b.legend_position;this.isLegendInset="inset"===b.legend_position;this.isLegendTop="top-left"===b.legend_inset_anchor||"top-right"===b.legend_inset_anchor;this.isLegendLeft="top-left"===b.legend_inset_anchor||"bottom-left"===b.legend_inset_anchor;this.legendItemHeight=this.legendItemWidth=this.legendStep=0;this.currentMaxTickWidths={x:0,y:0,y2:0};this.rotated_padding_left=30;this.rotated_padding_right=b.axis_rotated&&!b.axis_x_show?0:30;this.rotated_padding_top=5;this.withoutFadeIn={};this.intervalForObserveInserted=
void 0;this.axes.subx=a.selectAll([])};f.initChartElements=function(){this.initBar&&this.initBar();this.initLine&&this.initLine();this.initArc&&this.initArc();this.initGauge&&this.initGauge();this.initText&&this.initText()};f.initWithData=function(a){var b=this,e=b.d3,l=b.config,q=!0;b.axis=new m(b);b.initPie&&b.initPie();b.initBrush&&b.initBrush();b.initZoom&&b.initZoom();b.selectChart=l.bindto?"function"===typeof l.bindto.node?l.bindto:e.select(l.bindto):e.selectAll([]);b.selectChart.empty()&&(b.selectChart=
e.select(document.createElement("div")).style("opacity",0),b.observeInserted(b.selectChart),q=!1);b.selectChart.html("").classed("c3",!0);b.data.xs={};b.data.targets=b.convertDataToTargets(a);l.data_filter&&(b.data.targets=b.data.targets.filter(l.data_filter));l.data_hide&&b.addHiddenTargetIds(!0===l.data_hide?b.mapToIds(b.data.targets):l.data_hide);l.legend_hide&&b.addHiddenLegendIds(!0===l.legend_hide?b.mapToIds(b.data.targets):l.legend_hide);b.hasType("gauge")&&(l.legend_show=!1);b.updateSizes();
b.updateScales();b.x.domain(e.extent(b.getXDomain(b.data.targets)));b.y.domain(b.getYDomain(b.data.targets,"y"));b.y2.domain(b.getYDomain(b.data.targets,"y2"));b.subX.domain(b.x.domain());b.subY.domain(b.y.domain());b.subY2.domain(b.y2.domain());b.orgXDomain=b.x.domain();b.brush&&b.brush.scale(b.subX);l.zoom_enabled&&b.zoom.scale(b.x);b.svg=b.selectChart.append("svg").style("overflow","hidden").on("mouseenter",function(){return l.onmouseover.call(b)}).on("mouseleave",function(){return l.onmouseout.call(b)});
a=b.svg.append("defs");b.clipChart=b.appendClip(a,b.clipId);b.clipXAxis=b.appendClip(a,b.clipIdForXAxis);b.clipYAxis=b.appendClip(a,b.clipIdForYAxis);b.clipGrid=b.appendClip(a,b.clipIdForGrid);b.clipSubchart=b.appendClip(a,b.clipIdForSubchart);b.updateSvgSize();a=b.main=b.svg.append("g").attr("transform",b.getTranslate("main"));b.initSubchart&&b.initSubchart();b.initTooltip&&b.initTooltip();b.initLegend&&b.initLegend();b.initTitle&&b.initTitle();a.append("text").attr("class",g.text+" "+g.empty).attr("text-anchor",
"middle").attr("dominant-baseline","middle");b.initRegion();b.initGrid();a.append("g").attr("clip-path",b.clipPath).attr("class",g.chart);l.grid_lines_front&&b.initGridLines();b.initEventRect();b.initChartElements();a.insert("rect",l.zoom_privileged?null:"g."+g.regions).attr("class",g.zoomRect).attr("width",b.width).attr("height",b.height).style("opacity",0).on("dblclick.zoom",null);l.axis_x_extent&&b.brush.extent(b.getDefaultExtent());b.axis.init();b.updateTargets(b.data.targets);q&&(b.updateDimension(),
b.config.oninit.call(b),b.redraw({withTransition:!1,withTransform:!0,withUpdateXDomain:!0,withUpdateOrgXDomain:!0,withTransitionForAxis:!1}));null==h.onresize&&(h.onresize=b.generateResize());h.onresize.add&&(h.onresize.add(function(){l.onresize.call(b)}),h.onresize.add(function(){b.api.flush()}),h.onresize.add(function(){l.onresized.call(b)}));b.api.element=b.selectChart.node()};f.smoothLines=function(a,b){var e=this;"grid"===b&&a.each(function(){var a=e.d3.select(this),b=a.attr("x1"),f=a.attr("x2"),
p=a.attr("y1"),g=a.attr("y2");a.attr({x1:Math.ceil(b),x2:Math.ceil(f),y1:Math.ceil(p),y2:Math.ceil(g)})})};f.updateSizes=function(){var a=this.config,b=this.legend?this.getLegendHeight():0,e=this.legend?this.getLegendWidth():0,l=this.isLegendRight||this.isLegendInset?0:b,q=this.hasArcType(),f=a.axis_rotated||q?0:this.getHorizontalAxisHeight("x"),p=a.subchart_show&&!q?a.subchart_size_height+f:0;this.currentWidth=this.getCurrentWidth();this.currentHeight=this.getCurrentHeight();this.margin=a.axis_rotated?
{top:this.getHorizontalAxisHeight("y2")+this.getCurrentPaddingTop(),right:q?0:this.getCurrentPaddingRight(),bottom:this.getHorizontalAxisHeight("y")+l+this.getCurrentPaddingBottom(),left:p+(q?0:this.getCurrentPaddingLeft())}:{top:4+this.getCurrentPaddingTop(),right:q?0:this.getCurrentPaddingRight(),bottom:f+p+l+this.getCurrentPaddingBottom(),left:q?0:this.getCurrentPaddingLeft()};this.margin2=a.axis_rotated?{top:this.margin.top,right:NaN,bottom:20+l,left:this.rotated_padding_left}:{top:this.currentHeight-
p-l,right:NaN,bottom:f+l,left:this.margin.left};this.margin3={top:0,right:NaN,bottom:0,left:0};this.updateSizeForLegend&&this.updateSizeForLegend(b,e);this.width=this.currentWidth-this.margin.left-this.margin.right;this.height=this.currentHeight-this.margin.top-this.margin.bottom;0>this.width&&(this.width=0);0>this.height&&(this.height=0);this.width2=a.axis_rotated?this.margin.left-this.rotated_padding_left-this.rotated_padding_right:this.width;this.height2=a.axis_rotated?this.height:this.currentHeight-
this.margin2.top-this.margin2.bottom;0>this.width2&&(this.width2=0);0>this.height2&&(this.height2=0);this.arcWidth=this.width-(this.isLegendRight?e+10:0);this.arcHeight=this.height-(this.isLegendRight?0:10);this.hasType("gauge")&&(this.arcHeight+=this.height-this.getGaugeLabelHeight());this.updateRadius&&this.updateRadius();this.isLegendRight&&q&&(this.margin3.left=this.arcWidth/2+1.1*this.radiusExpanded)};f.updateTargets=function(a){this.updateTargetsForText(a);this.updateTargetsForBar(a);this.updateTargetsForLine(a);
this.hasArcType()&&this.updateTargetsForArc&&this.updateTargetsForArc(a);this.updateTargetsForSubchart&&this.updateTargetsForSubchart(a);this.showTargets()};f.showTargets=function(){var a=this;a.svg.selectAll("."+g.target).filter(function(b){return a.isTargetToShow(b.id)}).transition().duration(a.config.transition_duration).style("opacity",1)};f.redraw=function(a,b){var e=this,l=e.main,q=e.d3,f=e.config,p=e.getShapeIndices(e.isAreaType),U=e.getShapeIndices(e.isBarType),t=e.getShapeIndices(e.isLineType),
y,D,h,m,n,r,u,w,G,P,ca,ea,S,K=e.hasArcType(),x,C,L,V,F,E,B,A,N=e.filterTargetsToShow(e.data.targets),R,aa,Q,T=e.xv.bind(e),J,O;a=a||{};y=H(a,"withY",!0);D=H(a,"withSubchart",!0);h=H(a,"withTransition",!0);r=H(a,"withTransform",!1);u=H(a,"withUpdateXDomain",!1);w=H(a,"withUpdateOrgXDomain",!1);G=H(a,"withTrimXDomain",!0);S=H(a,"withUpdateXAxis",u);P=H(a,"withLegend",!1);ca=H(a,"withEventRect",!0);ea=H(a,"withDimension",!0);m=H(a,"withTransitionForExit",h);n=H(a,"withTransitionForAxis",h);E=h?f.transition_duration:
0;m=m?E:0;b=b||e.axis.generateTransitions(n?E:0);P&&f.legend_show?e.updateLegend(e.mapToIds(e.data.targets),a,b):ea&&e.updateDimension(!0);e.isCategorized()&&0===N.length&&e.x.domain([0,e.axes.x.selectAll(".tick").size()]);N.length?(e.updateXDomain(N,u,w,G),f.axis_x_tick_values||(R=e.axis.updateXAxisTickValues(N))):(e.xAxis.tickValues([]),e.subXAxis.tickValues([]));f.zoom_rescale&&!a.flow&&(Q=e.x.orgDomain());e.y.domain(e.getYDomain(N,"y",Q));e.y2.domain(e.getYDomain(N,"y2",Q));!f.axis_y_tick_values&&
f.axis_y_tick_count&&e.yAxis.tickValues(e.axis.generateTickValues(e.y.domain(),f.axis_y_tick_count));!f.axis_y2_tick_values&&f.axis_y2_tick_count&&e.y2Axis.tickValues(e.axis.generateTickValues(e.y2.domain(),f.axis_y2_tick_count));e.axis.redraw(b,K);e.axis.updateLabels(h);if((u||S)&&N.length)if(f.axis_x_tick_culling&&R){for(h=1;h<R.length;h++)if(R.length/h<f.axis_x_tick_culling_max){aa=h;break}e.svg.selectAll("."+g.axisX+" .tick text").each(function(a){a=R.indexOf(a);0<=a&&q.select(this).style("display",
a%aa?"none":"block")})}else e.svg.selectAll("."+g.axisX+" .tick text").style("display","block");x=e.generateDrawArea?e.generateDrawArea(p,!1):void 0;C=e.generateDrawBar?e.generateDrawBar(U):void 0;L=e.generateDrawLine?e.generateDrawLine(t,!1):void 0;V=e.generateXYForText(p,U,t,!0);F=e.generateXYForText(p,U,t,!1);y&&(e.subY.domain(e.getYDomain(N,"y")),e.subY2.domain(e.getYDomain(N,"y2")));e.tooltip.style("display","none");e.updateXgridFocus();l.select("text."+g.text+"."+g.empty).attr("x",e.width/2).attr("y",
e.height/2).text(f.data_empty_label_text).transition().style("opacity",N.length?0:1);e.updateGrid(E);e.updateRegion(E);e.updateBar(m);e.updateLine(m);e.updateArea(m);e.updateCircle();e.hasDataLabel()&&e.updateText(m);e.redrawTitle&&e.redrawTitle();e.redrawArc&&e.redrawArc(E,m,r);e.redrawSubchart&&e.redrawSubchart(D,b,E,m,p,U,t);l.selectAll("."+g.selectedCircles).filter(e.isBarType.bind(e)).selectAll("circle").remove();f.interaction_enabled&&!a.flow&&ca&&(e.redrawEventRect(),e.updateZoom&&e.updateZoom());
e.updateCircleY();J=(e.config.axis_rotated?e.circleY:e.circleX).bind(e);O=(e.config.axis_rotated?e.circleX:e.circleY).bind(e);a.flow&&(A=e.generateFlow({targets:N,flow:a.flow,duration:a.flow.duration,drawBar:C,drawLine:L,drawArea:x,cx:J,cy:O,xv:T,xForText:V,yForText:F}));(E||A)&&e.isTabVisible()?q.transition().duration(E).each(function(){var b=[];[e.redrawBar(C,!0),e.redrawLine(L,!0),e.redrawArea(x,!0),e.redrawCircle(J,O,!0),e.redrawText(V,F,a.flow,!0),e.redrawRegion(!0),e.redrawGrid(!0)].forEach(function(a){a.forEach(function(a){b.push(a)})});
B=e.generateWait();b.forEach(function(a){B.add(a)})}).call(B,function(){A&&A();f.onrendered&&f.onrendered.call(e)}):(e.redrawBar(C),e.redrawLine(L),e.redrawArea(x),e.redrawCircle(J,O),e.redrawText(V,F,a.flow),e.redrawRegion(),e.redrawGrid(),f.onrendered&&f.onrendered.call(e));e.mapToIds(e.data.targets).forEach(function(a){e.withoutFadeIn[a]=!0})};f.updateAndRedraw=function(a){var b=this.config,e;a=a||{};a.withTransition=H(a,"withTransition",!0);a.withTransform=H(a,"withTransform",!1);a.withLegend=
H(a,"withLegend",!1);a.withUpdateXDomain=!0;a.withUpdateOrgXDomain=!0;a.withTransitionForExit=!1;a.withTransitionForTransform=H(a,"withTransitionForTransform",a.withTransition);this.updateSizes();a.withLegend&&b.legend_show||(e=this.axis.generateTransitions(a.withTransitionForAxis?b.transition_duration:0),this.updateScales(),this.updateSvgSize(),this.transformAll(a.withTransitionForTransform,e));this.redraw(a,e)};f.redrawWithoutRescale=function(){this.redraw({withY:!1,withSubchart:!1,withEventRect:!1,
withTransitionForAxis:!1})};f.isTimeSeries=function(){return"timeseries"===this.config.axis_x_type};f.isCategorized=function(){return 0<=this.config.axis_x_type.indexOf("categor")};f.isCustomX=function(){var a=this.config;return!this.isTimeSeries()&&(a.data_x||A(a.data_xs))};f.isTimeSeriesY=function(){return"timeseries"===this.config.axis_y_type};f.getTranslate=function(a){var b=this.config,e,l;"main"===a?(e=Z(this.margin.left),l=Z(this.margin.top)):"context"===a?(e=Z(this.margin2.left),l=Z(this.margin2.top)):
"legend"===a?(e=this.margin3.left,l=this.margin3.top):"x"===a?(e=0,l=b.axis_rotated?0:this.height):"y"===a?(e=0,l=b.axis_rotated?this.height:0):"y2"===a?(e=b.axis_rotated?0:this.width,l=b.axis_rotated?1:0):"subx"===a?(e=0,l=b.axis_rotated?0:this.height2):"arc"===a&&(e=this.arcWidth/2,l=this.arcHeight/2);return"translate("+e+","+l+")"};f.initialOpacity=function(a){return null!==a.value&&this.withoutFadeIn[a.id]?1:0};f.initialOpacityForCircle=function(a){return null!==a.value&&this.withoutFadeIn[a.id]?
this.opacityForCircle(a):0};f.opacityForCircle=function(a){var b=this.config.point_show?1:0;return w(a.value)?this.isScatterType(a)?.5:b:0};f.opacityForText=function(){return this.hasDataLabel()?1:0};f.xx=function(a){return a?this.x(a.x):null};f.xv=function(a){var b=a.value;this.isTimeSeries()?b=this.parseDate(a.value):this.isCategorized()&&"string"===typeof a.value&&(b=this.config.axis_x_categories.indexOf(a.value));return Math.ceil(this.x(b))};f.yv=function(a){return Math.ceil((a.axis&&"y2"===a.axis?
this.y2:this.y)(a.value))};f.subxx=function(a){return a?this.subX(a.x):null};f.transformMain=function(a,b){var e,l,q;b&&b.axisX?e=b.axisX:(e=this.main.select("."+g.axisX),a&&(e=e.transition()));b&&b.axisY?l=b.axisY:(l=this.main.select("."+g.axisY),a&&(l=l.transition()));b&&b.axisY2?q=b.axisY2:(q=this.main.select("."+g.axisY2),a&&(q=q.transition()));(a?this.main.transition():this.main).attr("transform",this.getTranslate("main"));e.attr("transform",this.getTranslate("x"));l.attr("transform",this.getTranslate("y"));
q.attr("transform",this.getTranslate("y2"));this.main.select("."+g.chartArcs).attr("transform",this.getTranslate("arc"))};f.transformAll=function(a,b){this.transformMain(a,b);this.config.subchart_show&&this.transformContext(a,b);this.legend&&this.transformLegend(a)};f.updateSvgSize=function(){var a=this.svg.select(".c3-brush .background");this.svg.attr("width",this.currentWidth).attr("height",this.currentHeight);this.svg.selectAll(["#"+this.clipId,"#"+this.clipIdForGrid]).select("rect").attr("width",
this.width).attr("height",this.height);this.svg.select("#"+this.clipIdForXAxis).select("rect").attr("x",this.getXAxisClipX.bind(this)).attr("y",this.getXAxisClipY.bind(this)).attr("width",this.getXAxisClipWidth.bind(this)).attr("height",this.getXAxisClipHeight.bind(this));this.svg.select("#"+this.clipIdForYAxis).select("rect").attr("x",this.getYAxisClipX.bind(this)).attr("y",this.getYAxisClipY.bind(this)).attr("width",this.getYAxisClipWidth.bind(this)).attr("height",this.getYAxisClipHeight.bind(this));
this.svg.select("#"+this.clipIdForSubchart).select("rect").attr("width",this.width).attr("height",a.size()?a.attr("height"):0);this.svg.select("."+g.zoomRect).attr("width",this.width).attr("height",this.height);this.selectChart.style("max-height",this.currentHeight+"px")};f.updateDimension=function(a){a||(this.config.axis_rotated?(this.axes.x.call(this.xAxis),this.axes.subx.call(this.subXAxis)):(this.axes.y.call(this.yAxis),this.axes.y2.call(this.y2Axis)));this.updateSizes();this.updateScales();this.updateSvgSize();
this.transformAll(!1)};f.observeInserted=function(a){var b=this,e;"undefined"===typeof MutationObserver?h.console.error("MutationObserver not defined."):(e=new MutationObserver(function(l){l.forEach(function(l){"childList"===l.type&&l.previousSibling&&(e.disconnect(),b.intervalForObserveInserted=h.setInterval(function(){a.node().parentNode&&(h.clearInterval(b.intervalForObserveInserted),b.updateDimension(),b.brush&&b.brush.update(),b.config.oninit.call(b),b.redraw({withTransform:!0,withUpdateXDomain:!0,
withUpdateOrgXDomain:!0,withTransition:!1,withTransitionForTransform:!1,withLegend:!0}),a.transition().style("opacity",1))},10))})}),e.observe(a.node(),{attributes:!0,childList:!0,characterData:!0}))};f.generateResize=function(){function a(){b.forEach(function(a){a()})}var b=[];a.add=function(a){b.push(a)};return a};f.endall=function(a,b){var e=0;a.each(function(){++e}).each("end",function(){--e||b.apply(this,arguments)})};f.generateWait=function(){var a=[],b=function(b,l){var q=setInterval(function(){var b=
0;a.forEach(function(a){if(a.empty())b+=1;else try{a.transition()}catch(e){b+=1}});b===a.length&&(clearInterval(q),l&&l())},10)};b.add=function(b){a.push(b)};return b};f.parseDate=function(a){var b;a instanceof Date?b=a:"string"===typeof a?b=this.dataTimeFormat(this.config.data_xFormat).parse(a):"number"!==typeof a&&isNaN(a)||(b=new Date(+a));b&&!isNaN(+b)||h.console.error("Failed to parse x '"+a+"' to Date object");return b};f.isTabVisible=function(){var a;"undefined"!==typeof document.hidden?a=
"hidden":"undefined"!==typeof document.mozHidden?a="mozHidden":"undefined"!==typeof document.msHidden?a="msHidden":"undefined"!==typeof document.webkitHidden&&(a="webkitHidden");return document[a]?!1:!0};f.getDefaultConfig=function(){var a={bindto:"#chart",size_width:void 0,size_height:void 0,padding_left:void 0,padding_right:void 0,padding_top:void 0,padding_bottom:void 0,zoom_enabled:!1,zoom_extent:void 0,zoom_privileged:!1,zoom_rescale:!1,zoom_onzoom:function(){},zoom_onzoomstart:function(){},
zoom_onzoomend:function(){},interaction_enabled:!0,onmouseover:function(){},onmouseout:function(){},onresize:function(){},onresized:function(){},oninit:function(){},onrendered:function(){},transition_duration:350,data_x:void 0,data_xs:{},data_xFormat:"%Y-%m-%d",data_xLocaltime:!0,data_xSort:!0,data_idConverter:function(a){return a},data_names:{},data_classes:{},data_groups:[],data_axes:{},data_type:void 0,data_types:{},data_labels:{},data_order:"desc",data_regions:{},data_color:void 0,data_colors:{},
data_hide:!1,data_filter:void 0,data_selection_enabled:!1,data_selection_grouped:!1,data_selection_isselectable:function(){return!0},data_selection_multiple:!0,data_selection_draggable:!1,data_onclick:function(){},data_onmouseover:function(){},data_onmouseout:function(){},data_onselected:function(){},data_onunselected:function(){},data_url:void 0,data_json:void 0,data_rows:void 0,data_columns:void 0,data_mimeType:void 0,data_keys:void 0,data_empty_label_text:"",subchart_show:!1,subchart_size_height:60,
subchart_onbrush:function(){},color_pattern:[],color_threshold:{},legend_show:!0,legend_hide:!1,legend_position:"bottom",legend_inset_anchor:"top-left",legend_inset_x:10,legend_inset_y:0,legend_inset_step:void 0,legend_item_onclick:void 0,legend_item_onmouseover:void 0,legend_item_onmouseout:void 0,legend_equally:!1,axis_rotated:!1,axis_x_show:!0,axis_x_type:"indexed",axis_x_localtime:!0,axis_x_categories:[],axis_x_tick_centered:!1,axis_x_tick_format:void 0,axis_x_tick_culling:{},axis_x_tick_culling_max:10,
axis_x_tick_count:void 0,axis_x_tick_fit:!0,axis_x_tick_values:null,axis_x_tick_rotate:0,axis_x_tick_outer:!0,axis_x_tick_multiline:!0,axis_x_tick_width:null,axis_x_max:void 0,axis_x_min:void 0,axis_x_padding:{},axis_x_height:void 0,axis_x_extent:void 0,axis_x_label:{},axis_y_show:!0,axis_y_type:void 0,axis_y_max:void 0,axis_y_min:void 0,axis_y_inverted:!1,axis_y_center:void 0,axis_y_inner:void 0,axis_y_label:{},axis_y_tick_format:void 0,axis_y_tick_outer:!0,axis_y_tick_values:null,axis_y_tick_count:void 0,
axis_y_tick_time_value:void 0,axis_y_tick_time_interval:void 0,axis_y_padding:{},axis_y_default:void 0,axis_y2_show:!1,axis_y2_max:void 0,axis_y2_min:void 0,axis_y2_inverted:!1,axis_y2_center:void 0,axis_y2_inner:void 0,axis_y2_label:{},axis_y2_tick_format:void 0,axis_y2_tick_outer:!0,axis_y2_tick_values:null,axis_y2_tick_count:void 0,axis_y2_padding:{},axis_y2_default:void 0,grid_x_show:!1,grid_x_type:"tick",grid_x_lines:[],grid_y_show:!1,grid_y_lines:[],grid_y_ticks:10,grid_focus_show:!0,grid_lines_front:!0,
point_show:!0,point_r:2.5,point_focus_expand_enabled:!0,point_focus_expand_r:void 0,point_select_r:void 0,line_connectNull:!1,line_step_type:"step",bar_width:void 0,bar_width_ratio:.6,bar_width_max:void 0,bar_zerobased:!0,area_zerobased:!0,pie_label_show:!0,pie_label_format:void 0,pie_label_threshold:.05,pie_expand:!0,gauge_label_show:!0,gauge_label_format:void 0,gauge_expand:!0,gauge_min:0,gauge_max:100,gauge_units:void 0,gauge_width:void 0,donut_label_show:!0,donut_label_format:void 0,donut_label_threshold:.05,
donut_width:void 0,donut_expand:!0,donut_title:"",regions:[],tooltip_show:!0,tooltip_grouped:!0,tooltip_format_title:void 0,tooltip_format_name:void 0,tooltip_format_value:void 0,tooltip_position:void 0,tooltip_contents:function(a,e,l,q){return this.getTooltipContent?this.getTooltipContent(a,e,l,q):""},tooltip_init_show:!1,tooltip_init_x:0,tooltip_init_position:{top:"0px",left:"50px"},title_text:void 0,title_padding:{top:0,right:0,bottom:0,left:0},title_position:"top-center"};Object.keys(this.additionalConfig).forEach(function(b){a[b]=
this.additionalConfig[b]},this);return a};f.additionalConfig={};f.loadConfig=function(a){function b(){var a=q.shift();return a&&l&&"object"===typeof l&&a in l?(l=l[a],b()):a?void 0:l}var e=this.config,l,q,f;Object.keys(e).forEach(function(p){l=a;q=p.split("_");f=b();E(f)&&(e[p]=f)})};f.getScale=function(a,b,e){return(e?this.d3.time.scale():this.d3.scale.linear()).range([a,b])};f.getX=function(a,b,e,l){var q=this.getScale(a,b,this.isTimeSeries()),f=e?q.domain(e):q,p;this.isCategorized()?(l=l||function(){return 0},
q=function(a,b){var e=f(a)+l(a);return b?e:Math.ceil(e)}):q=function(a,b){var e=f(a);return b?e:Math.ceil(e)};for(p in f)q[p]=f[p];q.orgDomain=function(){return f.domain()};this.isCategorized()&&(q.domain=function(a){if(!arguments.length)return a=this.orgDomain(),[a[0],a[1]+1];f.domain(a);return q});return q};f.getY=function(a,b,e){a=this.getScale(a,b,this.isTimeSeriesY());e&&a.domain(e);return a};f.getYScale=function(a){return"y2"===this.axis.getId(a)?this.y2:this.y};f.getSubYScale=function(a){return"y2"===
this.axis.getId(a)?this.subY2:this.subY};f.updateScales=function(){var a=this,b=a.config,e=!a.x;a.xMin=b.axis_rotated?1:0;a.xMax=b.axis_rotated?a.height:a.width;a.yMin=b.axis_rotated?0:a.height;a.yMax=b.axis_rotated?a.width:1;a.subXMin=a.xMin;a.subXMax=a.xMax;a.subYMin=b.axis_rotated?0:a.height2;a.subYMax=b.axis_rotated?a.width2:1;a.x=a.getX(a.xMin,a.xMax,e?void 0:a.x.orgDomain(),function(){return a.xAxis.tickOffset()});a.y=a.getY(a.yMin,a.yMax,e?b.axis_y_default:a.y.domain());a.y2=a.getY(a.yMin,
a.yMax,e?b.axis_y2_default:a.y2.domain());a.subX=a.getX(a.xMin,a.xMax,a.orgXDomain,function(b){return b%1?0:a.subXAxis.tickOffset()});a.subY=a.getY(a.subYMin,a.subYMax,e?b.axis_y_default:a.subY.domain());a.subY2=a.getY(a.subYMin,a.subYMax,e?b.axis_y2_default:a.subY2.domain());a.xAxisTickFormat=a.axis.getXAxisTickFormat();a.xAxisTickValues=a.axis.getXAxisTickValues();a.yAxisTickValues=a.axis.getYAxisTickValues();a.y2AxisTickValues=a.axis.getY2AxisTickValues();a.xAxis=a.axis.getXAxis(a.x,a.xOrient,
a.xAxisTickFormat,a.xAxisTickValues,b.axis_x_tick_outer);a.subXAxis=a.axis.getXAxis(a.subX,a.subXOrient,a.xAxisTickFormat,a.xAxisTickValues,b.axis_x_tick_outer);a.yAxis=a.axis.getYAxis(a.y,a.yOrient,b.axis_y_tick_format,a.yAxisTickValues,b.axis_y_tick_outer);a.y2Axis=a.axis.getYAxis(a.y2,a.y2Orient,b.axis_y2_tick_format,a.y2AxisTickValues,b.axis_y2_tick_outer);e||(a.brush&&a.brush.scale(a.subX),b.zoom_enabled&&a.zoom.scale(a.x));a.updateArc&&a.updateArc()};f.getYDomainMin=function(a){var b=this,e=
b.config,l=b.mapToIds(a),q=b.getValuesAsIdKeyed(a),f,p,g,t,y;if(0<e.data_groups.length)for(y=b.hasNegativeValueInTargets(a),a=0;a<e.data_groups.length;a++)if(g=e.data_groups[a].filter(function(a){return 0<=l.indexOf(a)}),0!==g.length)for(p=g[0],y&&q[p]&&q[p].forEach(function(a,b){q[p][b]=0>a?a:0}),f=1;f<g.length;f++)t=g[f],q[t]&&q[t].forEach(function(a,e){b.axis.getId(t)!==b.axis.getId(p)||!q[p]||y&&0<+a||(q[p][e]+=+a)});return b.d3.min(Object.keys(q).map(function(a){return b.d3.min(q[a])}))};f.getYDomainMax=
function(a){var b=this,e=b.config,l=b.mapToIds(a),q=b.getValuesAsIdKeyed(a),f,p,g,t,y;if(0<e.data_groups.length)for(y=b.hasPositiveValueInTargets(a),a=0;a<e.data_groups.length;a++)if(g=e.data_groups[a].filter(function(a){return 0<=l.indexOf(a)}),0!==g.length)for(p=g[0],y&&q[p]&&q[p].forEach(function(a,b){q[p][b]=0<a?a:0}),f=1;f<g.length;f++)t=g[f],q[t]&&q[t].forEach(function(a,e){b.axis.getId(t)!==b.axis.getId(p)||!q[p]||y&&0>+a||(q[p][e]+=+a)});return b.d3.max(Object.keys(q).map(function(a){return b.d3.max(q[a])}))};
f.getYDomain=function(a,b,e){var l=this,q=l.config;a=a.filter(function(a){return l.axis.getId(a.id)===b});var f=e?l.filterByXDomain(a,e):a,p="y2"===b?q.axis_y2_min:q.axis_y_min,g="y2"===b?q.axis_y2_max:q.axis_y_max,t=l.getYDomainMin(f);a=l.getYDomainMax(f);var y,h="y2"===b?q.axis_y2_center:q.axis_y_center,m,n,r=l.hasType("bar",f)&&q.bar_zerobased||l.hasType("area",f)&&q.area_zerobased;e="y2"===b?q.axis_y2_inverted:q.axis_y_inverted;m=l.hasDataLabel()&&q.axis_rotated;var u=l.hasDataLabel()&&!q.axis_rotated,
t=w(p)?p:w(g)?t<g?t:g-10:t;a=w(g)?g:w(p)?p<a?a:p+10:a;if(0===f.length)return"y2"===b?l.y2.domain():l.y.domain();isNaN(t)&&(t=0);isNaN(a)&&(a=t);t===a&&(0>t?a=0:t=0);f=0<=t&&0<=a;n=0>=t&&0>=a;if(w(p)&&f||w(g)&&n)r=!1;r&&(f&&(t=0),n&&(a=0));p=Math.abs(a-t);g=y=.1*p;"undefined"!==typeof h&&(t=Math.max(Math.abs(t),Math.abs(a)),a=h+t,t=h-t);m?(h=l.getDataLabelLength(t,a,"width"),m=T(l.y.range()),h=[h[0]/m,h[1]/m],g+=h[1]/(1-h[0]-h[1])*p,y+=h[0]/(1-h[0]-h[1])*p):u&&(h=l.getDataLabelLength(t,a,"height"),
g+=l.axis.convertPixelsToAxisPadding(h[1],p),y+=l.axis.convertPixelsToAxisPadding(h[0],p));"y"===b&&A(q.axis_y_padding)&&(g=l.axis.getPadding(q.axis_y_padding,"top",g,p),y=l.axis.getPadding(q.axis_y_padding,"bottom",y,p));"y2"===b&&A(q.axis_y2_padding)&&(g=l.axis.getPadding(q.axis_y2_padding,"top",g,p),y=l.axis.getPadding(q.axis_y2_padding,"bottom",y,p));r&&(f&&(y=t),n&&(g=-a));q=[t-y,a+g];return e?q.reverse():q};f.getXDomainMin=function(a){var b=this,e=b.config;return E(e.axis_x_min)?b.isTimeSeries()?
this.parseDate(e.axis_x_min):e.axis_x_min:b.d3.min(a,function(a){return b.d3.min(a.values,function(a){return a.x})})};f.getXDomainMax=function(a){var b=this,e=b.config;return E(e.axis_x_max)?b.isTimeSeries()?this.parseDate(e.axis_x_max):e.axis_x_max:b.d3.max(a,function(a){return b.d3.max(a.values,function(a){return a.x})})};f.getXDomainPadding=function(a){var b=this.config;a=a[1]-a[0];var e,l;this.isCategorized()?a=0:this.hasType("bar")?(e=this.getMaxDataCount(),a=1<e?a/(e-1)/2:.5):a*=.01;"object"===
typeof b.axis_x_padding&&A(b.axis_x_padding)?(e=w(b.axis_x_padding.left)?b.axis_x_padding.left:a,l=w(b.axis_x_padding.right)?b.axis_x_padding.right:a):e="number"===typeof b.axis_x_padding?l=b.axis_x_padding:l=a;return{left:e,right:l}};f.getXDomain=function(a){var b=[this.getXDomainMin(a),this.getXDomainMax(a)];a=b[0];var e=b[1],b=this.getXDomainPadding(b),l=0,q=0;0!==a-e||this.isCategorized()||(this.isTimeSeries()?(a=new Date(.5*a.getTime()),e=new Date(1.5*e.getTime())):(a=0===a?1:.5*a,e=0===e?-1:
1.5*e));if(a||0===a)l=this.isTimeSeries()?new Date(a.getTime()-b.left):a-b.left;if(e||0===e)q=this.isTimeSeries()?new Date(e.getTime()+b.right):e+b.right;return[l,q]};f.updateXDomain=function(a,b,e,l,q){var f=this.config;e&&(this.x.domain(q?q:this.d3.extent(this.getXDomain(a))),this.orgXDomain=this.x.domain(),f.zoom_enabled&&this.zoom.scale(this.x).updateScaleExtent(),this.subX.domain(this.x.domain()),this.brush&&this.brush.scale(this.subX));b&&(this.x.domain(q?q:!this.brush||this.brush.empty()?this.orgXDomain:
this.brush.extent()),f.zoom_enabled&&this.zoom.scale(this.x).updateScaleExtent());l&&this.x.domain(this.trimXDomain(this.x.orgDomain()));return this.x.domain()};f.trimXDomain=function(a){a[0]<=this.orgXDomain[0]&&(a[1]=+a[1]+(this.orgXDomain[0]-a[0]),a[0]=this.orgXDomain[0]);this.orgXDomain[1]<=a[1]&&(a[0]=+a[0]-(a[1]-this.orgXDomain[1]),a[1]=this.orgXDomain[1]);return a};f.isX=function(a){var b=this.config;return b.data_x&&a===b.data_x||A(b.data_xs)&&ia(b.data_xs,a)};f.isNotX=function(a){return!this.isX(a)};
f.getXKey=function(a){var b=this.config;return b.data_x?b.data_x:A(b.data_xs)?b.data_xs[a]:null};f.getXValuesOfXKey=function(a,b){var e=this,l;(b&&A(b)?e.mapToIds(b):[]).forEach(function(b){e.getXKey(b)===a&&(l=e.data.xs[b])});return l};f.getIndexByX=function(a){a=this.filterByX(this.data.targets,a);return a.length?a[0].index:null};f.getXValue=function(a,b){return a in this.data.xs&&this.data.xs[a]&&w(this.data.xs[a][b])?this.data.xs[a][b]:b};f.getOtherTargetXs=function(){var a=Object.keys(this.data.xs);
return a.length?this.data.xs[a[0]]:null};f.getOtherTargetX=function(a){var b=this.getOtherTargetXs();return b&&a<b.length?b[a]:null};f.addXs=function(a){var b=this;Object.keys(a).forEach(function(e){b.config.data_xs[e]=a[e]})};f.hasMultipleX=function(a){return 1<this.d3.set(Object.keys(a).map(function(b){return a[b]})).size()};f.isMultipleX=function(){return A(this.config.data_xs)||!this.config.data_xSort||this.hasType("scatter")};f.addName=function(a){var b;a&&(b=this.config.data_names[a.id],a.name=
b?b:a.id);return a};f.getValueOnIndex=function(a,b){var e=a.filter(function(a){return a.index===b});return e.length?e[0]:null};f.updateTargetX=function(a,b){var e=this;a.forEach(function(a){a.values.forEach(function(q,f){q.x=e.generateTargetX(b[f],a.id,f)});e.data.xs[a.id]=b})};f.updateTargetXs=function(a,b){var e=this;a.forEach(function(a){b[a.id]&&e.updateTargetX([a],b[a.id])})};f.generateTargetX=function(a,b,e){return this.isTimeSeries()?a?this.parseDate(a):this.parseDate(this.getXValue(b,e)):
this.isCustomX()&&!this.isCategorized()?w(a)?+a:this.getXValue(b,e):e};f.cloneTarget=function(a){return{id:a.id,id_org:a.id_org,values:a.values.map(function(a){return{x:a.x,value:a.value,id:a.id}})}};f.updateXs=function(){var a=this;a.data.targets.length&&(a.xs=[],a.data.targets[0].values.forEach(function(b){a.xs[b.index]=b.x}))};f.getPrevX=function(a){a=this.xs[a-1];return"undefined"!==typeof a?a:null};f.getNextX=function(a){a=this.xs[a+1];return"undefined"!==typeof a?a:null};f.getMaxDataCount=function(){return this.d3.max(this.data.targets,
function(a){return a.values.length})};f.getMaxDataCountTarget=function(a){var b=a.length,e=0,l;1<b?a.forEach(function(a){a.values.length>e&&(l=a,e=a.values.length)}):l=b?a[0]:null;return l};f.getEdgeX=function(a){return a.length?[this.d3.min(a,function(a){return a.values[0].x}),this.d3.max(a,function(a){return a.values[a.values.length-1].x})]:[0,0]};f.mapToIds=function(a){return a.map(function(a){return a.id})};f.mapToTargetIds=function(a){return a?C(a)?[a]:a:this.mapToIds(this.data.targets)};f.hasTarget=
function(a,b){var e=this.mapToIds(a),l;for(l=0;l<e.length;l++)if(e[l]===b)return!0;return!1};f.isTargetToShow=function(a){return 0>this.hiddenTargetIds.indexOf(a)};f.isLegendToShow=function(a){return 0>this.hiddenLegendIds.indexOf(a)};f.filterTargetsToShow=function(a){var b=this;return a.filter(function(a){return b.isTargetToShow(a.id)})};f.mapTargetsToUniqueXs=function(a){a=this.d3.set(this.d3.merge(a.map(function(a){return a.values.map(function(a){return+a.x})}))).values();return this.isTimeSeries()?
a.map(function(a){return new Date(+a)}):a.map(function(a){return+a})};f.addHiddenTargetIds=function(a){this.hiddenTargetIds=this.hiddenTargetIds.concat(a)};f.removeHiddenTargetIds=function(a){this.hiddenTargetIds=this.hiddenTargetIds.filter(function(b){return 0>a.indexOf(b)})};f.addHiddenLegendIds=function(a){this.hiddenLegendIds=this.hiddenLegendIds.concat(a)};f.removeHiddenLegendIds=function(a){this.hiddenLegendIds=this.hiddenLegendIds.filter(function(b){return 0>a.indexOf(b)})};f.getValuesAsIdKeyed=
function(a){var b={};a.forEach(function(a){b[a.id]=[];a.values.forEach(function(l){b[a.id].push(l.value)})});return b};f.checkValueInTargets=function(a,b){var e=Object.keys(a),l,q,f;for(l=0;l<e.length;l++)for(f=a[e[l]].values,q=0;q<f.length;q++)if(b(f[q].value))return!0;return!1};f.hasNegativeValueInTargets=function(a){return this.checkValueInTargets(a,function(a){return 0>a})};f.hasPositiveValueInTargets=function(a){return this.checkValueInTargets(a,function(a){return 0<a})};f.isOrderDesc=function(){var a=
this.config;return"string"===typeof a.data_order&&"desc"===a.data_order.toLowerCase()};f.isOrderAsc=function(){var a=this.config;return"string"===typeof a.data_order&&"asc"===a.data_order.toLowerCase()};f.orderTargets=function(a){var b=this.config,e=this.isOrderAsc(),l=this.isOrderDesc();e||l?a.sort(function(a,b){var l=function(a,b){return a+Math.abs(b.value)},f=a.values.reduce(l,0),l=b.values.reduce(l,0);return e?l-f:f-l}):J(b.data_order)&&a.sort(b.data_order);return a};f.filterByX=function(a,b){return this.d3.merge(a.map(function(a){return a.values})).filter(function(a){return 0===
a.x-b})};f.filterRemoveNull=function(a){return a.filter(function(a){return w(a.value)})};f.filterByXDomain=function(a,b){return a.map(function(a){return{id:a.id,id_org:a.id_org,values:a.values.filter(function(a){return b[0]<=a.x&&a.x<=b[1]})}})};f.hasDataLabel=function(){var a=this.config;return"boolean"===typeof a.data_labels&&a.data_labels||"object"===typeof a.data_labels&&A(a.data_labels)?!0:!1};f.getDataLabelLength=function(a,b,e){var l=this,q=[0,0];l.selectChart.select("svg").selectAll(".dummy").data([a,
b]).enter().append("text").text(function(a){return l.dataLabelFormat(a.id)(a)}).each(function(a,b){q[b]=1.3*this.getBoundingClientRect()[e]}).remove();return q};f.isNoneArc=function(a){return this.hasTarget(this.data.targets,a.id)};f.isArc=function(a){return"data"in a&&this.hasTarget(this.data.targets,a.data.id)};f.findSameXOfValues=function(a,b){var e,l=a[b].x,q=[];for(e=b-1;0<=e&&l===a[e].x;e--)q.push(a[e]);for(e=b;e<a.length&&l===a[e].x;e++)q.push(a[e]);return q};f.findClosestFromTargets=function(a,
b){var e=this,l;l=a.map(function(a){return e.findClosest(a.values,b)});return e.findClosest(l,b)};f.findClosest=function(a,b){var e=this,l=100,q;a.filter(function(a){return a&&e.isBarType(a.id)}).forEach(function(a){var b=e.main.select("."+g.bars+e.getTargetSelectorSuffix(a.id)+" ."+g.bar+"-"+a.index).node();!q&&e.isWithinBar(b)&&(q=a)});a.filter(function(a){return a&&!e.isBarType(a.id)}).forEach(function(a){var f=e.dist(a,b);f<l&&(l=f,q=a)});return q};f.dist=function(a,b){var e=this.config,l=e.axis_rotated?
1:0,e=e.axis_rotated?0:1,q=this.circleY(a,a.index),f=this.x(a.x);return Math.pow(f-b[l],2)+Math.pow(q-b[e],2)};f.convertValuesToStep=function(a){var b=[].concat(a),e;if(!this.isCategorized())return a;for(e=a.length+1;0<e;e--)b[e]=b[e-1];b[0]={x:b[0].x-1,value:b[0].value,id:b[0].id};b[a.length+1]={x:b[a.length].x+1,value:b[a.length].value,id:b[a.length].id};return b};f.updateDataAttributes=function(a,b){var e=this.config["data_"+a];if("undefined"===typeof b)return e;Object.keys(b).forEach(function(a){e[a]=
b[a]});this.redraw({withLegend:!0});return e};f.convertUrlToData=function(a,b,e,l){var f=this,g=b?b:"csv";f.d3.xhr(a,function(a,b){var t;if(!b)throw Error(a.responseURL+" "+a.status+" ("+a.statusText+")");t="json"===g?f.convertJsonToData(JSON.parse(b.response),e):"tsv"===g?f.convertTsvToData(b.response):f.convertCsvToData(b.response);l.call(f,t)})};f.convertXsvToData=function(a,b){var e=b.parseRows(a),l;1===e.length?(l=[{}],e[0].forEach(function(a){l[0][a]=null})):l=b.parse(a);return l};f.convertCsvToData=
function(a){return this.convertXsvToData(a,this.d3.csv)};f.convertTsvToData=function(a){return this.convertXsvToData(a,this.d3.tsv)};f.convertJsonToData=function(a,b){var e=[],l,f;b?(b.x?(l=b.value.concat(b.x),this.config.data_x=b.x):l=b.value,e.push(l),a.forEach(function(a){var b=[];l.forEach(function(e){e=F(a[e])?null:a[e];b.push(e)});e.push(b)}),f=this.convertRowsToData(e)):(Object.keys(a).forEach(function(b){e.push([b].concat(a[b]))}),f=this.convertColumnsToData(e));return f};f.convertRowsToData=
function(a){var b=a[0],e={},l=[],f,g;for(f=1;f<a.length;f++){e={};for(g=0;g<a[f].length;g++){if(F(a[f][g]))throw Error("Source data is missing a component at ("+f+","+g+")!");e[b[g]]=a[f][g]}l.push(e)}return l};f.convertColumnsToData=function(a){var b=[],e,l,f;for(e=0;e<a.length;e++)for(f=a[e][0],l=1;l<a[e].length;l++){F(b[l-1])&&(b[l-1]={});if(F(a[e][l]))throw Error("Source data is missing a component at ("+e+","+l+")!");b[l-1][f]=a[e][l]}return b};f.convertDataToTargets=function(a,b){var e=this,
l=e.config,f=e.d3.keys(a[0]).filter(e.isNotX,e),g=e.d3.keys(a[0]).filter(e.isX,e);f.forEach(function(f){var q=e.getXKey(f);e.isCustomX()||e.isTimeSeries()?0<=g.indexOf(q)?e.data.xs[f]=(b&&e.data.xs[f]?e.data.xs[f]:[]).concat(a.map(function(a){return a[q]}).filter(w).map(function(a,b){return e.generateTargetX(a,f,b)})):l.data_x?e.data.xs[f]=e.getOtherTargetXs():A(l.data_xs)&&(e.data.xs[f]=e.getXValuesOfXKey(q,e.data.targets)):e.data.xs[f]=a.map(function(a,b){return b})});f.forEach(function(a){if(!e.data.xs[a])throw Error('x is not defined for id = "'+
a+'".');});f=f.map(function(b,f){var q=l.data_idConverter(b);return{id:q,id_org:b,values:a.map(function(a,g){var v=e.getXKey(b),v=a[v],h=e.generateTargetX(v,b,g);e.isCustomX()&&e.isCategorized()&&0===f&&v&&(0===g&&(l.axis_x_categories=[]),l.axis_x_categories.push(v));if(F(a[b])||e.data.xs[b].length<=g)h=void 0;return{x:h,value:null===a[b]||isNaN(a[b])?null:+a[b],id:q}}).filter(function(a){return E(a.x)})}});f.forEach(function(a){var b;l.data_xSort&&(a.values=a.values.sort(function(a,b){return(a.x||
0===a.x?a.x:Infinity)-(b.x||0===b.x?b.x:Infinity)}));b=0;a.values.forEach(function(a){a.index=b++});e.data.xs[a.id].sort(function(a,b){return a-b})});l.data_type&&e.setTargetType(e.mapToIds(f).filter(function(a){return!(a in l.data_types)}),l.data_type);f.forEach(function(a){e.addCache(a.id_org,a)});return f};f.load=function(a,b){var e=this;a&&(b.filter&&(a=a.filter(b.filter)),(b.type||b.types)&&a.forEach(function(a){e.setTargetType(a.id,b.types&&b.types[a.id]?b.types[a.id]:b.type)}),e.data.targets.forEach(function(b){for(var e=
0;e<a.length;e++)if(b.id===a[e].id){b.values=a[e].values;a.splice(e,1);break}}),e.data.targets=e.data.targets.concat(a));e.updateTargets(e.data.targets);e.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0});b.done&&b.done()};f.loadFromArgs=function(a){var b=this;a.data?b.load(b.convertDataToTargets(a.data),a):a.url?b.convertUrlToData(a.url,a.mimeType,a.keys,function(e){b.load(b.convertDataToTargets(e),a)}):a.json?b.load(b.convertDataToTargets(b.convertJsonToData(a.json,a.keys)),a):
a.rows?b.load(b.convertDataToTargets(b.convertRowsToData(a.rows)),a):a.columns?b.load(b.convertDataToTargets(b.convertColumnsToData(a.columns)),a):b.load(null,a)};f.unload=function(a,b){var e=this;b||(b=function(){});(a=a.filter(function(a){return e.hasTarget(e.data.targets,a)}))&&0!==a.length?(e.svg.selectAll(a.map(function(a){return e.selectorTarget(a)})).transition().style("opacity",0).remove().call(e.endall,b),a.forEach(function(a){e.withoutFadeIn[a]=!1;e.legend&&e.legend.selectAll("."+g.legendItem+
e.getTargetSelectorSuffix(a)).remove();e.data.targets=e.data.targets.filter(function(b){return b.id!==a})})):b()};f.categoryName=function(a){var b=this.config;return a<b.axis_x_categories.length?b.axis_x_categories[a]:a};f.initEventRect=function(){this.main.select("."+g.chart).append("g").attr("class",g.eventRects).style("fill-opacity",0)};f.redrawEventRect=function(){var a=this.config,b;b=this.isMultipleX();a=this.main.select("."+g.eventRects).style("cursor",a.zoom_enabled?a.axis_rotated?"ns-resize":
"ew-resize":null).classed(g.eventRectsMultiple,b).classed(g.eventRectsSingle,!b);a.selectAll("."+g.eventRect).remove();this.eventRect=a.selectAll("."+g.eventRect);b?(b=this.eventRect.data([0]),this.generateEventRectsForMultipleXs(b.enter()),this.updateEventRect(b)):(b=this.getMaxDataCountTarget(this.data.targets),a.datum(b?b.values:[]),this.eventRect=a.selectAll("."+g.eventRect),b=this.eventRect.data(function(a){return a}),this.generateEventRectsForSingleX(b.enter()),this.updateEventRect(b),b.exit().remove())};
f.updateEventRect=function(a){var b=this,e=b.config,l,f,g,p,h;a=a||b.eventRect.data(function(a){return a});b.isMultipleX()?(f=l=0,g=b.width,p=b.height):(!b.isCustomX()&&!b.isTimeSeries()||b.isCategorized()?(h=b.getEventRectWidth(),f=function(a){return b.x(a.x)-h/2}):(b.updateXs(),h=function(a){var l=b.getPrevX(a.index);a=b.getNextX(a.index);if(null===l&&null===a)return e.axis_rotated?b.height:b.width;null===l&&(l=b.x.domain()[0]);null===a&&(a=b.x.domain()[1]);return Math.max(0,(b.x(a)-b.x(l))/2)},
f=function(a){var e=b.getPrevX(a.index),l=b.getNextX(a.index);a=b.data.xs[a.id][a.index];if(null===e&&null===l)return 0;null===e&&(e=b.x.domain()[0]);return(b.x(a)+b.x(e))/2}),l=e.axis_rotated?0:f,f=e.axis_rotated?f:0,g=e.axis_rotated?b.width:h,p=e.axis_rotated?h:b.height);a.attr("class",b.classEvent.bind(b)).attr("x",l).attr("y",f).attr("width",g).attr("height",p)};f.generateEventRectsForSingleX=function(a){var b=this,e=b.d3,l=b.config;a.append("rect").attr("class",b.classEvent.bind(b)).style("cursor",
l.data_selection_enabled&&l.data_selection_grouped?"pointer":null).on("mouseover",function(a){a=a.index;b.dragging||b.flowing||b.hasArcType()||(l.point_focus_expand_enabled&&b.expandCircles(a,null,!0),b.expandBars(a,null,!0),b.main.selectAll("."+g.shape+"-"+a).each(function(a){l.data_onmouseover.call(b.api,a)}))}).on("mouseout",function(a){a=a.index;b.config&&!b.hasArcType()&&(b.hideXGridFocus(),b.hideTooltip(),b.unexpandCircles(),b.unexpandBars(),b.main.selectAll("."+g.shape+"-"+a).each(function(a){l.data_onmouseout.call(b.api,
a)}))}).on("mousemove",function(a){var f=a.index,p=b.svg.select("."+g.eventRect+"-"+f);b.dragging||b.flowing||b.hasArcType()||(b.isStepType(a)&&"step-after"===b.config.line_step_type&&e.mouse(this)[0]<b.x(b.getXValue(a.id,f))&&--f,a=b.filterTargetsToShow(b.data.targets).map(function(a){return b.addName(b.getValueOnIndex(a.values,f))}),l.tooltip_grouped&&(b.showTooltip(a,this),b.showXGridFocus(a)),(!l.tooltip_grouped||l.data_selection_enabled&&!l.data_selection_grouped)&&b.main.selectAll("."+g.shape+
"-"+f).each(function(){e.select(this).classed(g.EXPANDED,!0);l.data_selection_enabled&&p.style("cursor",l.data_selection_grouped?"pointer":null);l.tooltip_grouped||(b.hideXGridFocus(),b.hideTooltip(),l.data_selection_grouped||(b.unexpandCircles(f),b.unexpandBars(f)))}).filter(function(a){return b.isWithinShape(this,a)}).each(function(a){l.data_selection_enabled&&(l.data_selection_grouped||l.data_selection_isselectable(a))&&p.style("cursor","pointer");l.tooltip_grouped||(b.showTooltip([a],this),b.showXGridFocus([a]),
l.point_focus_expand_enabled&&b.expandCircles(f,a.id,!0),b.expandBars(f,a.id,!0))}))}).on("click",function(a){var f=a.index;!b.hasArcType()&&b.toggleShape&&(b.cancelClick?b.cancelClick=!1:(b.isStepType(a)&&"step-after"===l.line_step_type&&e.mouse(this)[0]<b.x(b.getXValue(a.id,f))&&--f,b.main.selectAll("."+g.shape+"-"+f).each(function(a){if(l.data_selection_grouped||b.isWithinShape(this,a))b.toggleShape(this,a,f),b.config.data_onclick.call(b.api,a,this)})))}).call(l.data_selection_draggable&&b.drag?
e.behavior.drag().origin(Object).on("drag",function(){b.drag(e.mouse(this))}).on("dragstart",function(){b.dragstart(e.mouse(this))}).on("dragend",function(){b.dragend()}):function(){})};f.generateEventRectsForMultipleXs=function(a){function b(){e.svg.select("."+g.eventRect).style("cursor",null);e.hideXGridFocus();e.hideTooltip();e.unexpandCircles();e.unexpandBars()}var e=this,l=e.d3,f=e.config;a.append("rect").attr("x",0).attr("y",0).attr("width",e.width).attr("height",e.height).attr("class",g.eventRect).on("mouseout",
function(){e.config&&(e.hasArcType()||b())}).on("mousemove",function(){var a=e.filterTargetsToShow(e.data.targets),p,h;if(!e.dragging&&!e.hasArcType(a))if(p=l.mouse(this),h=e.findClosestFromTargets(a,p),!e.mouseover||h&&h.id===e.mouseover.id||(f.data_onmouseout.call(e.api,e.mouseover),e.mouseover=void 0),h){if(a=e.isScatterType(h)||!f.tooltip_grouped?[h]:e.filterByX(a,h.x),a=a.map(function(a){return e.addName(a)}),e.showTooltip(a,this),f.point_focus_expand_enabled&&e.expandCircles(h.index,h.id,!0),
e.expandBars(h.index,h.id,!0),e.showXGridFocus(a),e.isBarType(h.id)||100>e.dist(h,p))e.svg.select("."+g.eventRect).style("cursor","pointer"),e.mouseover||(f.data_onmouseover.call(e.api,h),e.mouseover=h)}else b()}).on("click",function(){var a=e.filterTargetsToShow(e.data.targets),b,h;e.hasArcType(a)||(b=l.mouse(this),(h=e.findClosestFromTargets(a,b))&&(e.isBarType(h.id)||100>e.dist(h,b))&&e.main.selectAll("."+g.shapes+e.getTargetSelectorSuffix(h.id)).selectAll("."+g.shape+"-"+h.index).each(function(){if(f.data_selection_grouped||
e.isWithinShape(this,h))e.toggleShape(this,h,h.index),e.config.data_onclick.call(e.api,h,this)}))}).call(f.data_selection_draggable&&e.drag?l.behavior.drag().origin(Object).on("drag",function(){e.drag(l.mouse(this))}).on("dragstart",function(){e.dragstart(l.mouse(this))}).on("dragend",function(){e.dragend()}):function(){})};f.dispatchEvent=function(a,b,e){b="."+g.eventRect+(this.isMultipleX()?"":"-"+b);b=this.main.select(b).node();var l=b.getBoundingClientRect(),f=l.left+(e?e[0]:0);e=l.top+(e?e[1]:
0);l=document.createEvent("MouseEvents");l.initMouseEvent(a,!0,!0,h,0,f,e,f,e,!1,!1,!1,!1,0,null);b.dispatchEvent(l)};f.getCurrentWidth=function(){var a=this.config;return a.size_width?a.size_width:this.getParentWidth()};f.getCurrentHeight=function(){var a=this.config,a=a.size_height?a.size_height:this.getParentHeight();return 0<a?a:320/(this.hasType("gauge")?2:1)};f.getCurrentPaddingTop=function(){var a=this.config,a=w(a.padding_top)?a.padding_top:0;this.title&&this.title.node()&&(a+=this.getTitlePadding());
return a};f.getCurrentPaddingBottom=function(){var a=this.config;return w(a.padding_bottom)?a.padding_bottom:0};f.getCurrentPaddingLeft=function(a){var b=this.config;return w(b.padding_left)?b.padding_left:b.axis_rotated?b.axis_x_show?Math.max(X(this.getAxisWidthByAxisId("x",a)),40):1:!b.axis_y_show||b.axis_y_inner?this.axis.getYAxisLabelPosition().isOuter?30:1:X(this.getAxisWidthByAxisId("y",a))};f.getCurrentPaddingRight=function(){var a=this.config,b=this.isLegendRight?this.getLegendWidth()+20:
0;return w(a.padding_right)?a.padding_right+1:a.axis_rotated?10+b:!a.axis_y2_show||a.axis_y2_inner?2+b+(this.axis.getY2AxisLabelPosition().isOuter?20:0):X(this.getAxisWidthByAxisId("y2"))+b};f.getParentRectValue=function(a){for(var b=this.selectChart.node(),e;b&&"BODY"!==b.tagName;){try{e=b.getBoundingClientRect()[a]}catch(l){"width"===a&&(e=b.offsetWidth)}if(e)break;b=b.parentNode}return e};f.getParentWidth=function(){return this.getParentRectValue("width")};f.getParentHeight=function(){var a=this.selectChart.style("height");
return 0<a.indexOf("px")?+a.replace("px",""):0};f.getSvgLeft=function(a){var b=this.config,e=b.axis_rotated||!b.axis_rotated&&!b.axis_y_inner,e=(b=this.main.select("."+(b.axis_rotated?g.axisX:g.axisY)).node())&&e?b.getBoundingClientRect():{right:0},b=this.selectChart.node().getBoundingClientRect(),l=this.hasArcType();a=e.right-b.left-(l?0:this.getCurrentPaddingLeft(a));return 0<a?a:0};f.getAxisWidthByAxisId=function(a,b){var e=this.axis.getLabelPositionById(a);return this.axis.getMaxTickWidth(a,b)+
(e.isInner?20:40)};f.getHorizontalAxisHeight=function(a){var b=this.config,e=30;if("x"===a&&!b.axis_x_show)return 8;if("x"===a&&b.axis_x_height)return b.axis_x_height;if("y"===a&&!b.axis_y_show)return!b.legend_show||this.isLegendRight||this.isLegendInset?1:10;if("y2"===a&&!b.axis_y2_show)return this.rotated_padding_top;"x"===a&&!b.axis_rotated&&b.axis_x_tick_rotate&&(e=30+this.axis.getMaxTickWidth(a)*Math.cos(Math.PI*(90-b.axis_x_tick_rotate)/180));return e+(this.axis.getLabelPositionById(a).isInner?
0:10)+("y2"===a?-10:0)};f.getEventRectWidth=function(){return Math.max(0,this.xAxis.tickInterval())};f.getShapeIndices=function(a){var b=this.config,e={},l=0,f,g;this.filterTargetsToShow(this.data.targets.filter(a,this)).forEach(function(a){for(f=0;f<b.data_groups.length;f++)if(!(0>b.data_groups[f].indexOf(a.id)))for(g=0;g<b.data_groups[f].length;g++)if(b.data_groups[f][g]in e){e[a.id]=e[b.data_groups[f][g]];break}F(e[a.id])&&(e[a.id]=l++)});e.__max__=l-1;return e};f.getShapeX=function(a,b,e,l){var f=
l?this.subX:this.x;return function(l){var g=l.id in e?e[l.id]:0;return l.x||0===l.x?f(l.x)-a*(b/2-g):0}};f.getShapeY=function(a){var b=this;return function(e){return(a?b.getSubYScale(e.id):b.getYScale(e.id))(e.value)}};f.getShapeOffset=function(a,b,e){var l=this,f=l.orderTargets(l.filterTargetsToShow(l.data.targets.filter(a,l))),g=f.map(function(a){return a.id});return function(a,h){var t=e?l.getSubYScale(a.id):l.getYScale(a.id),y=t(0),D=y;f.forEach(function(e){var f=l.isStepType(a)?l.convertValuesToStep(e.values):
e.values;e.id!==a.id&&b[e.id]===b[a.id]&&g.indexOf(e.id)<g.indexOf(a.id)&&0<=f[h].value*a.value&&(D+=t(f[h].value)-y)});return D}};f.isWithinShape=function(a,b){var e=this.d3.select(a),l;this.isTargetToShow(b.id)?"circle"===a.nodeName?l=this.isStepType(b)?this.isWithinStep(a,this.getYScale(b.id)(b.value)):this.isWithinCircle(a,1.5*this.pointSelectR(b)):"path"===a.nodeName&&(l=e.classed(g.bar)?this.isWithinBar(a):!0):l=!1;return l};f.getInterpolate=function(a){return this.isSplineType(a)?"cardinal":
this.isStepType(a)?this.config.line_step_type:"linear"};f.initLine=function(){this.main.select("."+g.chart).append("g").attr("class",g.chartLines)};f.updateTargetsForLine=function(a){var b=this,e=b.config,l,f=b.classChartLine.bind(b),v=b.classLines.bind(b),p=b.classAreas.bind(b),h=b.classCircles.bind(b),t=b.classFocus.bind(b);l=b.main.select("."+g.chartLines).selectAll("."+g.chartLine).data(a).attr("class",function(a){return f(a)+t(a)}).enter().append("g").attr("class",f).style("opacity",0).style("pointer-events",
"none");l.append("g").attr("class",v);l.append("g").attr("class",p);l.append("g").attr("class",function(a){return b.generateClass(g.selectedCircles,a.id)});l.append("g").attr("class",h).style("cursor",function(a){return e.data_selection_isselectable(a)?"pointer":null});a.forEach(function(a){b.main.selectAll("."+g.selectedCircles+b.getTargetSelectorSuffix(a.id)).selectAll("."+g.selectedCircle).each(function(b){b.value=a.values[b.index].value})})};f.updateLine=function(a){var b=this;b.mainLine=b.main.selectAll("."+
g.lines).selectAll("."+g.line).data(b.lineData.bind(b));b.mainLine.enter().append("path").attr("class",b.classLine.bind(b)).style("stroke",b.color);b.mainLine.style("opacity",b.initialOpacity.bind(b)).style("shape-rendering",function(a){return b.isStepType(a)?"crispEdges":""}).attr("transform",null);b.mainLine.exit().transition().duration(a).style("opacity",0).remove()};f.redrawLine=function(a,b){return[(b?this.mainLine.transition():this.mainLine).attr("d",a).style("stroke",this.color).style("opacity",
1)]};f.generateDrawLine=function(a,b){var e=this,l=e.config,f=e.d3.svg.line(),g=e.generateGetLinePoints(a,b),p=b?e.getSubYScale:e.getYScale,h=function(a){return(b?e.subxx:e.xx).call(e,a)},t=function(a,b){return 0<l.data_groups.length?g(a,b)[0][1]:p.call(e,a.id)(a.value)},f=l.axis_rotated?f.x(t).y(h):f.x(h).y(t);l.line_connectNull||(f=f.defined(function(a){return null!=a.value}));return function(a){var g=l.line_connectNull?e.filterRemoveNull(a.values):a.values,v=b?e.x:e.subX,h=p.call(e,a.id),t=0,U=
0;e.isLineType(a)?l.data_regions[a.id]?a=e.lineWithRegions(g,v,h,l.data_regions[a.id]):(e.isStepType(a)&&(g=e.convertValuesToStep(g)),a=f.interpolate(e.getInterpolate(a))(g)):(g[0]&&(t=v(g[0].x),U=h(g[0].value)),a=l.axis_rotated?"M "+U+" "+t:"M "+t+" "+U);return a?a:"M 0 0"}};f.generateGetLinePoints=function(a,b){var e=this,l=e.config,f=e.getShapeX(0,a.__max__+1,a,!!b),g=e.getShapeY(!!b),p=e.getShapeOffset(e.isLineType,a,!!b),h=b?e.getSubYScale:e.getYScale;return function(a,b){var D=h.call(e,a.id)(0),
m=p(a,b)||D,n=f(a),r=g(a);l.axis_rotated&&(0<a.value&&r<D||0>a.value&&D<r)&&(r=D);return[[n,r-(D-m)],[n,r-(D-m)],[n,r-(D-m)],[n,r-(D-m)]]}};f.lineWithRegions=function(a,b,e,l){function f(a,b){var e;for(e=0;e<b.length;e++)if(b[e].start<a&&a<=b[e].end)return!0;return!1}function g(a){return"M"+a[0][0]+" "+a[0][1]+" "+a[1][0]+" "+a[1][1]}var p=this.config,h,t,m="M",D,n,r,u,w=this.isCategorized()?.5:0,M,x,G=[];if(E(l))for(h=0;h<l.length;h++)G[h]={},F(l[h].start)?G[h].start=a[0].x:G[h].start=this.isTimeSeries()?
this.parseDate(l[h].start):l[h].start,F(l[h].end)?G[h].end=a[a.length-1].x:G[h].end=this.isTimeSeries()?this.parseDate(l[h].end):l[h].end;M=p.axis_rotated?function(a){return e(a.value)}:function(a){return b(a.x)};x=p.axis_rotated?function(a){return b(a.x)}:function(a){return e(a.value)};l=this.isTimeSeries()?function(a,l,f,q){var h=a.x.getTime();l=l.x-a.x;a=new Date(h+l*f);h=new Date(h+l*(f+q));f=p.axis_rotated?[[e(n(f)),b(a)],[e(n(f+q)),b(h)]]:[[b(a),e(n(f))],[b(h),e(n(f+q))]];return g(f)}:function(a,
l,f,q){a=p.axis_rotated?[[e(n(f),!0),b(D(f))],[e(n(f+q),!0),b(D(f+q))]]:[[b(D(f),!0),e(n(f))],[b(D(f+q),!0),e(n(f+q))]];return g(a)};for(h=0;h<a.length;h++)if(F(G)||!f(a[h].x,G))m+=" "+M(a[h])+" "+x(a[h]);else for(D=this.getScale(a[h-1].x+w,a[h].x+w,this.isTimeSeries()),n=this.getScale(a[h-1].value,a[h].value),t=b(a[h].x)-b(a[h-1].x),r=e(a[h].value)-e(a[h-1].value),t=Math.sqrt(Math.pow(t,2)+Math.pow(r,2)),r=2/t,u=2*r,t=r;1>=t;t+=u)m+=l(a[h-1],a[h],t,r);return m};f.updateArea=function(a){var b=this,
e=b.d3;b.mainArea=b.main.selectAll("."+g.areas).selectAll("."+g.area).data(b.lineData.bind(b));b.mainArea.enter().append("path").attr("class",b.classArea.bind(b)).style("fill",b.color).style("opacity",function(){b.orgAreaOpacity=+e.select(this).style("opacity");return 0});b.mainArea.style("opacity",b.orgAreaOpacity);b.mainArea.exit().transition().duration(a).style("opacity",0).remove()};f.redrawArea=function(a,b){return[(b?this.mainArea.transition():this.mainArea).attr("d",a).style("fill",this.color).style("opacity",
this.orgAreaOpacity)]};f.generateDrawArea=function(a,b){var e=this,l=e.config,f=e.d3.svg.area(),g=e.generateGetAreaPoints(a,b),h=b?e.getSubYScale:e.getYScale,m=function(a){return(b?e.subxx:e.xx).call(e,a)},t=function(a,b){return 0<l.data_groups.length?g(a,b)[0][1]:h.call(e,a.id)(e.getAreaBaseValue(a.id))},n=function(a,b){return 0<l.data_groups.length?g(a,b)[1][1]:h.call(e,a.id)(a.value)},f=l.axis_rotated?f.x0(t).x1(n).y(m):f.x(m).y0(t).y1(n);l.line_connectNull||(f=f.defined(function(a){return null!==
a.value}));return function(a){var b=l.line_connectNull?e.filterRemoveNull(a.values):a.values,g=0,h=0;e.isAreaType(a)?(e.isStepType(a)&&(b=e.convertValuesToStep(b)),a=f.interpolate(e.getInterpolate(a))(b)):(b[0]&&(g=e.x(b[0].x),h=e.getYScale(a.id)(b[0].value)),a=l.axis_rotated?"M "+h+" "+g:"M "+g+" "+h);return a?a:"M 0 0"}};f.getAreaBaseValue=function(){return 0};f.generateGetAreaPoints=function(a,b){var e=this,l=e.config,f=e.getShapeX(0,a.__max__+1,a,!!b),g=e.getShapeY(!!b),h=e.getShapeOffset(e.isAreaType,
a,!!b),m=b?e.getSubYScale:e.getYScale;return function(a,b){var n=m.call(e,a.id)(0),r=h(a,b)||n,u=f(a),w=g(a);l.axis_rotated&&(0<a.value&&w<n||0>a.value&&n<w)&&(w=n);return[[u,r],[u,w-(n-r)],[u,w-(n-r)],[u,r]]}};f.updateCircle=function(){this.mainCircle=this.main.selectAll("."+g.circles).selectAll("."+g.circle).data(this.lineOrScatterData.bind(this));this.mainCircle.enter().append("circle").attr("class",this.classCircle.bind(this)).attr("r",this.pointR.bind(this)).style("fill",this.color);this.mainCircle.style("opacity",
this.initialOpacityForCircle.bind(this));this.mainCircle.exit().remove()};f.redrawCircle=function(a,b,e){var l=this.main.selectAll("."+g.selectedCircle);return[(e?this.mainCircle.transition():this.mainCircle).style("opacity",this.opacityForCircle.bind(this)).style("fill",this.color).attr("cx",a).attr("cy",b),(e?l.transition():l).attr("cx",a).attr("cy",b)]};f.circleX=function(a){return a.x||0===a.x?this.x(a.x):null};f.updateCircleY=function(){var a=this,b,e;0<a.config.data_groups.length?(b=a.getShapeIndices(a.isLineType),
e=a.generateGetLinePoints(b),a.circleY=function(a,b){return e(a,b)[0][1]}):a.circleY=function(b){return a.getYScale(b.id)(b.value)}};f.getCircles=function(a,b){return(b?this.main.selectAll("."+g.circles+this.getTargetSelectorSuffix(b)):this.main).selectAll("."+g.circle+(w(a)?"-"+a:""))};f.expandCircles=function(a,b,e){var l=this.pointExpandedR.bind(this);e&&this.unexpandCircles();this.getCircles(a,b).classed(g.EXPANDED,!0).attr("r",l)};f.unexpandCircles=function(a){var b=this,e=b.pointR.bind(b);b.getCircles(a).filter(function(){return b.d3.select(this).classed(g.EXPANDED)}).classed(g.EXPANDED,
!1).attr("r",e)};f.pointR=function(a){var b=this.config;return this.isStepType(a)?0:J(b.point_r)?b.point_r(a):b.point_r};f.pointExpandedR=function(a){var b=this.config;return b.point_focus_expand_enabled?b.point_focus_expand_r?b.point_focus_expand_r:1.75*this.pointR(a):this.pointR(a)};f.pointSelectR=function(a){var b=this.config;return b.point_select_r?b.point_select_r:4*this.pointR(a)};f.isWithinCircle=function(a,b){var e=this.d3,l=e.mouse(a),f=e.select(a),e=+f.attr("cx"),f=+f.attr("cy");return Math.sqrt(Math.pow(e-
l[0],2)+Math.pow(f-l[1],2))<b};f.isWithinStep=function(a,b){return 30>Math.abs(b-this.d3.mouse(a)[1])};f.initBar=function(){this.main.select("."+g.chart).append("g").attr("class",g.chartBars)};f.updateTargetsForBar=function(a){var b=this.config,e=this.classChartBar.bind(this),l=this.classBars.bind(this),f=this.classFocus.bind(this);this.main.select("."+g.chartBars).selectAll("."+g.chartBar).data(a).attr("class",function(a){return e(a)+f(a)}).enter().append("g").attr("class",e).style("opacity",0).style("pointer-events",
"none").append("g").attr("class",l).style("cursor",function(a){return b.data_selection_isselectable(a)?"pointer":null})};f.updateBar=function(a){var b=this,e=b.barData.bind(b),l=b.classBar.bind(b),f=b.initialOpacity.bind(b),h=function(a){return b.color(a.id)};b.mainBar=b.main.selectAll("."+g.bars).selectAll("."+g.bar).data(e);b.mainBar.enter().append("path").attr("class",l).style("stroke",h).style("fill",h);b.mainBar.style("opacity",f);b.mainBar.exit().transition().duration(a).style("opacity",0).remove()};
f.redrawBar=function(a,b){return[(b?this.mainBar.transition():this.mainBar).attr("d",a).style("fill",this.color).style("opacity",1)]};f.getBarW=function(a,b){var e=this.config,l="number"===typeof e.bar_width?e.bar_width:b?a.tickInterval()*e.bar_width_ratio/b:0;return e.bar_width_max&&l>e.bar_width_max?e.bar_width_max:l};f.getBars=function(a,b){return(b?this.main.selectAll("."+g.bars+this.getTargetSelectorSuffix(b)):this.main).selectAll("."+g.bar+(w(a)?"-"+a:""))};f.expandBars=function(a,b,e){e&&this.unexpandBars();
this.getBars(a,b).classed(g.EXPANDED,!0)};f.unexpandBars=function(a){this.getBars(a).classed(g.EXPANDED,!1)};f.generateDrawBar=function(a,b){var e=this.config,l=this.generateGetBarPoints(a,b);return function(a,b){var f=l(a,b),g=e.axis_rotated?1:0,h=e.axis_rotated?0:1;return"M "+f[0][g]+","+f[0][h]+" L"+f[1][g]+","+f[1][h]+" L"+f[2][g]+","+f[2][h]+" L"+f[3][g]+","+f[3][h]+" z"}};f.generateGetBarPoints=function(a,b){var e=this,l=a.__max__+1,f=e.getBarW(b?e.subXAxis:e.xAxis,l),g=e.getShapeX(f,l,a,!!b),
h=e.getShapeY(!!b),m=e.getShapeOffset(e.isBarType,a,!!b),t=b?e.getSubYScale:e.getYScale;return function(a,b){var l=t.call(e,a.id)(0),n=m(a,b)||l,r=g(a),u=h(a);e.config.axis_rotated&&(0<a.value&&u<l||0>a.value&&l<u)&&(u=l);return[[r,n],[r,u-(l-n)],[r+f,u-(l-n)],[r+f,n]]}};f.isWithinBar=function(a){var b=this.d3.mouse(a),e=a.getBoundingClientRect(),l=a.pathSegList.getItem(0),f=a.pathSegList.getItem(1);a=Math.min(l.x,f.x);l=Math.min(l.y,f.y);f=a+e.width+2;e=l+e.height+2;return a-2<b[0]&&b[0]<f&&l-2<
b[1]&&b[1]<e};f.initText=function(){this.main.select("."+g.chart).append("g").attr("class",g.chartTexts);this.mainText=this.d3.selectAll([])};f.updateTargetsForText=function(a){var b=this.classChartText.bind(this),e=this.classTexts.bind(this),l=this.classFocus.bind(this);this.main.select("."+g.chartTexts).selectAll("."+g.chartText).data(a).attr("class",function(a){return b(a)+l(a)}).enter().append("g").attr("class",b).style("opacity",0).style("pointer-events","none").append("g").attr("class",e)};
f.updateText=function(a){var b=this,e=b.config,l=b.barOrLineData.bind(b),f=b.classText.bind(b);b.mainText=b.main.selectAll("."+g.texts).selectAll("."+g.text).data(l);b.mainText.enter().append("text").attr("class",f).attr("text-anchor",function(a){return e.axis_rotated?0>a.value?"end":"start":"middle"}).style("stroke","none").style("fill",function(a){return b.color(a)}).style("fill-opacity",0);b.mainText.text(function(a,e,l){return b.dataLabelFormat(a.id)(a.value,a.id,e,l)});b.mainText.exit().transition().duration(a).style("fill-opacity",
0).remove()};f.redrawText=function(a,b,e,l){return[(l?this.mainText.transition():this.mainText).attr("x",a).attr("y",b).style("fill",this.color).style("fill-opacity",e?0:this.opacityForText.bind(this))]};f.getTextRect=function(a,b){var e=this.d3.select("body").append("div").classed("c3",!0),l;e.append("svg").style("visibility","hidden").style("position","fixed").style("top",0).style("left",0).selectAll(".dummy").data([a]).enter().append("text").classed(b?b:"",!0).text(a).each(function(){l=this.getBoundingClientRect()});
e.remove();return l};f.generateXYForText=function(a,b,e,l){var f=this,g=f.generateGetAreaPoints(a,!1),h=f.generateGetBarPoints(b,!1),m=f.generateGetLinePoints(e,!1),t=l?f.getXForText:f.getYForText;return function(a,b){var e=f.isAreaType(a)?g:f.isBarType(a)?h:m;return t.call(f,e(a,b),a,this)}};f.getXForText=function(a,b,e){e=e.getBoundingClientRect();var l;this.config.axis_rotated?(l=this.isBarType(b)?4:6,a=a[2][1]+l*(0>b.value?-1:1)):a=this.hasType("bar")?(a[2][0]+a[0][0])/2:a[0][0];null===b.value&&
(a>this.width?a=this.width-e.width:0>a&&(a=4));return a};f.getYForText=function(a,b,e){e=e.getBoundingClientRect();this.config.axis_rotated?a=(a[0][0]+a[2][0]+.6*e.height)/2:(a=a[2][1],0>b.value?(a+=e.height,this.isBarType(b)&&this.isSafari()?a-=3:!this.isBarType(b)&&this.isChrome()&&(a+=3)):a+=this.isBarType(b)?-3:-6);null!==b.value||this.config.axis_rotated||(a<e.height?a=e.height:a>this.height&&(a=this.height-4));return a};f.setTargetType=function(a,b){var e=this,l=e.config;e.mapToTargetIds(a).forEach(function(a){e.withoutFadeIn[a]=
b===l.data_types[a];l.data_types[a]=b});a||(l.data_type=b)};f.hasType=function(a,b){var e=this.config.data_types,l=!1;(b=b||this.data.targets)&&b.length?b.forEach(function(b){if((b=e[b.id])&&0<=b.indexOf(a)||!b&&"line"===a)l=!0}):Object.keys(e).length?Object.keys(e).forEach(function(b){e[b]===a&&(l=!0)}):l=this.config.data_type===a;return l};f.hasArcType=function(a){return this.hasType("pie",a)||this.hasType("donut",a)||this.hasType("gauge",a)};f.isLineType=function(a){var b=this.config;a=C(a)?a:
a.id;return!b.data_types[a]||0<="line spline area area-spline step area-step".split(" ").indexOf(b.data_types[a])};f.isStepType=function(a){a=C(a)?a:a.id;return 0<=["step","area-step"].indexOf(this.config.data_types[a])};f.isSplineType=function(a){a=C(a)?a:a.id;return 0<=["spline","area-spline"].indexOf(this.config.data_types[a])};f.isAreaType=function(a){a=C(a)?a:a.id;return 0<=["area","area-spline","area-step"].indexOf(this.config.data_types[a])};f.isBarType=function(a){a=C(a)?a:a.id;return"bar"===
this.config.data_types[a]};f.isScatterType=function(a){a=C(a)?a:a.id;return"scatter"===this.config.data_types[a]};f.isPieType=function(a){a=C(a)?a:a.id;return"pie"===this.config.data_types[a]};f.isGaugeType=function(a){a=C(a)?a:a.id;return"gauge"===this.config.data_types[a]};f.isDonutType=function(a){a=C(a)?a:a.id;return"donut"===this.config.data_types[a]};f.isArcType=function(a){return this.isPieType(a)||this.isDonutType(a)||this.isGaugeType(a)};f.lineData=function(a){return this.isLineType(a)?[a]:
[]};f.arcData=function(a){return this.isArcType(a.data)?[a]:[]};f.barData=function(a){return this.isBarType(a)?a.values:[]};f.lineOrScatterData=function(a){return this.isLineType(a)||this.isScatterType(a)?a.values:[]};f.barOrLineData=function(a){return this.isBarType(a)||this.isLineType(a)?a.values:[]};f.initGrid=function(){var a=this.config,b=this.d3;this.grid=this.main.append("g").attr("clip-path",this.clipPathForGrid).attr("class",g.grid);a.grid_x_show&&this.grid.append("g").attr("class",g.xgrids);
a.grid_y_show&&this.grid.append("g").attr("class",g.ygrids);a.grid_focus_show&&this.grid.append("g").attr("class",g.xgridFocus).append("line").attr("class",g.xgridFocus);this.xgrid=b.selectAll([]);a.grid_lines_front||this.initGridLines()};f.initGridLines=function(){var a=this.d3;this.gridLines=this.main.append("g").attr("clip-path",this.clipPathForGrid).attr("class",g.grid+" "+g.gridLines);this.gridLines.append("g").attr("class",g.xgridLines);this.gridLines.append("g").attr("class",g.ygridLines);
this.xgridLines=a.selectAll([])};f.updateXGrid=function(a){var b=this,e=b.config,l=b.d3,f=b.generateGridData(e.grid_x_type,b.x),h=b.isCategorized()?b.xAxis.tickOffset():0;b.xgridAttr=e.axis_rotated?{x1:0,x2:b.width,y1:function(a){return b.x(a)-h},y2:function(a){return b.x(a)-h}}:{x1:function(a){return b.x(a)+h},x2:function(a){return b.x(a)+h},y1:0,y2:b.height};b.xgrid=b.main.select("."+g.xgrids).selectAll("."+g.xgrid).data(f);b.xgrid.enter().append("line").attr("class",g.xgrid);a||b.xgrid.attr(b.xgridAttr).style("opacity",
function(){return+l.select(this).attr(e.axis_rotated?"y1":"x1")===(e.axis_rotated?b.height:0)?0:1});b.xgrid.exit().remove()};f.updateYGrid=function(){var a=this.config,b=this.yAxis.tickValues()||this.y.ticks(a.grid_y_ticks);this.ygrid=this.main.select("."+g.ygrids).selectAll("."+g.ygrid).data(b);this.ygrid.enter().append("line").attr("class",g.ygrid);this.ygrid.attr("x1",a.axis_rotated?this.y:0).attr("x2",a.axis_rotated?this.y:this.width).attr("y1",a.axis_rotated?0:this.y).attr("y2",a.axis_rotated?
this.height:this.y);this.ygrid.exit().remove();this.smoothLines(this.ygrid,"grid")};f.gridTextAnchor=function(a){return a.position?a.position:"end"};f.gridTextDx=function(a){return"start"===a.position?4:"middle"===a.position?0:-4};f.xGridTextX=function(a){return"start"===a.position?-this.height:"middle"===a.position?-this.height/2:0};f.yGridTextX=function(a){return"start"===a.position?0:"middle"===a.position?this.width/2:this.width};f.updateGrid=function(a){var b=this.main,e=this.config,l;this.grid.style("visibility",
this.hasArcType()?"hidden":"visible");b.select("line."+g.xgridFocus).style("visibility","hidden");e.grid_x_show&&this.updateXGrid();this.xgridLines=b.select("."+g.xgridLines).selectAll("."+g.xgridLine).data(e.grid_x_lines);l=this.xgridLines.enter().append("g").attr("class",function(a){return g.xgridLine+(a["class"]?" "+a["class"]:"")});l.append("line").style("opacity",0);l.append("text").attr("text-anchor",this.gridTextAnchor).attr("transform",e.axis_rotated?"":"rotate(-90)").attr("dx",this.gridTextDx).attr("dy",
-5).style("opacity",0);this.xgridLines.exit().transition().duration(a).style("opacity",0).remove();e.grid_y_show&&this.updateYGrid();this.ygridLines=b.select("."+g.ygridLines).selectAll("."+g.ygridLine).data(e.grid_y_lines);b=this.ygridLines.enter().append("g").attr("class",function(a){return g.ygridLine+(a["class"]?" "+a["class"]:"")});b.append("line").style("opacity",0);b.append("text").attr("text-anchor",this.gridTextAnchor).attr("transform",e.axis_rotated?"rotate(-90)":"").attr("dx",this.gridTextDx).attr("dy",
-5).style("opacity",0);b=this.yv.bind(this);this.ygridLines.select("line").transition().duration(a).attr("x1",e.axis_rotated?b:0).attr("x2",e.axis_rotated?b:this.width).attr("y1",e.axis_rotated?0:b).attr("y2",e.axis_rotated?this.height:b).style("opacity",1);this.ygridLines.select("text").transition().duration(a).attr("x",e.axis_rotated?this.xGridTextX.bind(this):this.yGridTextX.bind(this)).attr("y",b).text(function(a){return a.text}).style("opacity",1);this.ygridLines.exit().transition().duration(a).style("opacity",
0).remove()};f.redrawGrid=function(a){var b=this.config,e=this.xv.bind(this),l=this.xgridLines.select("line"),f=this.xgridLines.select("text");return[(a?l.transition():l).attr("x1",b.axis_rotated?0:e).attr("x2",b.axis_rotated?this.width:e).attr("y1",b.axis_rotated?e:0).attr("y2",b.axis_rotated?e:this.height).style("opacity",1),(a?f.transition():f).attr("x",b.axis_rotated?this.yGridTextX.bind(this):this.xGridTextX.bind(this)).attr("y",e).text(function(a){return a.text}).style("opacity",1)]};f.showXGridFocus=
function(a){var b=this.config;a=a.filter(function(a){return a&&w(a.value)});var e=this.main.selectAll("line."+g.xgridFocus),l=this.xx.bind(this);!b.tooltip_show||this.hasType("scatter")||this.hasArcType()||(e.style("visibility","visible").data([a[0]]).attr(b.axis_rotated?"y1":"x1",l).attr(b.axis_rotated?"y2":"x2",l),this.smoothLines(e,"grid"))};f.hideXGridFocus=function(){this.main.select("line."+g.xgridFocus).style("visibility","hidden")};f.updateXgridFocus=function(){var a=this.config;this.main.select("line."+
g.xgridFocus).attr("x1",a.axis_rotated?0:-10).attr("x2",a.axis_rotated?this.width:-10).attr("y1",a.axis_rotated?-10:0).attr("y2",a.axis_rotated?-10:this.height)};f.generateGridData=function(a,b){var e=[],l,f;f=this.main.select("."+g.axisX).selectAll(".tick").size();if("year"===a)for(l=this.getXDomain(),f=l[0].getFullYear(),l=l[1].getFullYear();f<=l;f++)e.push(new Date(f+"-01-01 00:00:00"));else e=b.ticks(10),e.length>f&&(e=e.filter(function(a){return 0>(""+a).indexOf(".")}));return e};f.getGridFilterToRemove=
function(a){return a?function(b){var e=!1;[].concat(a).forEach(function(a){if("value"in a&&b.value===a.value||"class"in a&&b["class"]===a["class"])e=!0});return e}:function(){return!0}};f.removeGridLines=function(a,b){var e=this.config,l=this.getGridFilterToRemove(a),f=function(a){return!l(a)},h=b?g.xgridLine:g.ygridLine;this.main.select("."+(b?g.xgridLines:g.ygridLines)).selectAll("."+h).filter(l).transition().duration(e.transition_duration).style("opacity",0).remove();b?e.grid_x_lines=e.grid_x_lines.filter(f):
e.grid_y_lines=e.grid_y_lines.filter(f)};f.initTooltip=function(){var a=this,b=a.config,e;a.tooltip=a.selectChart.style("position","relative").append("div").attr("class",g.tooltipContainer).style("position","absolute").style("pointer-events","none").style("display","none");if(b.tooltip_init_show){if(a.isTimeSeries()&&C(b.tooltip_init_x)){b.tooltip_init_x=a.parseDate(b.tooltip_init_x);for(e=0;e<a.data.targets[0].values.length&&0!==a.data.targets[0].values[e].x-b.tooltip_init_x;e++);b.tooltip_init_x=
e}a.tooltip.html(b.tooltip_contents.call(a,a.data.targets.map(function(e){return a.addName(e.values[b.tooltip_init_x])}),a.axis.getXAxisTickFormat(),a.getYFormat(a.hasArcType()),a.color));a.tooltip.style("top",b.tooltip_init_position.top).style("left",b.tooltip_init_position.left).style("display","block")}};f.getTooltipContent=function(a,b,e,l){var f=this.config;b=f.tooltip_format_title||b;var h=f.tooltip_format_name||function(a){return a};e=f.tooltip_format_value||e;for(var p,m,t,n,f=0;f<a.length;f++)a[f]&&
(a[f].value||0===a[f].value)&&(p||(p=b?b(a[f].x):a[f].x,p="<table class='"+g.tooltip+"'>"+(p||0===p?"<tr><th colspan='2'>"+p+"</th></tr>":"")),m=e(a[f].value,a[f].ratio,a[f].id,a[f].index),void 0!==m&&(t=h(a[f].name,a[f].ratio,a[f].id,a[f].index),n=this.levelColor?this.levelColor(a[f].value):l(a[f].id),p+="<tr class='"+g.tooltipName+"-"+a[f].id+"'>",p+="<td class='name'><span style='background-color:"+n+"'></span>"+t+"</td>",p+="<td class='value'>"+m+"</td>",p+="</tr>"));return p+"</table>"};f.tooltipPosition=
function(a,b,e,l){var f=this.config,g=this.d3,h;h=this.hasArcType();l=g.mouse(l);h?(f=(this.width-(this.isLegendRight?this.getLegendWidth():0))/2+l[0],a=this.height/2+l[1]+20):(h=this.getSvgLeft(!0),f.axis_rotated?(f=h+l[0]+100,b=f+b,h=this.currentWidth-this.getCurrentPaddingRight(),a=this.x(a[0].x)+20):(f=h+this.getCurrentPaddingLeft(!0)+this.x(a[0].x)+20,b=f+b,h=h+this.currentWidth-this.getCurrentPaddingRight(),a=l[1]+15),b>h&&(f-=b-h+20),a+e>this.currentHeight&&(a-=e+30));0>a&&(a=0);return{top:a,
left:f}};f.showTooltip=function(a,b){var e=this.config,l,g;l=this.hasArcType();g=a.filter(function(a){return a&&w(a.value)});var h=e.tooltip_position||f.tooltipPosition;0!==g.length&&e.tooltip_show&&(this.tooltip.html(e.tooltip_contents.call(this,a,this.axis.getXAxisTickFormat(),this.getYFormat(l),this.color)).style("display","block"),e=this.tooltip.property("offsetWidth"),l=this.tooltip.property("offsetHeight"),g=h.call(this,g,e,l,b),this.tooltip.style("top",g.top+"px").style("left",g.left+"px"))};
f.hideTooltip=function(){this.tooltip.style("display","none")};f.initLegend=function(){this.legendItemTextBox={};this.legendHasRendered=!1;this.legend=this.svg.append("g").attr("transform",this.getTranslate("legend"));this.config.legend_show?this.updateLegendWithDefaults():(this.legend.style("visibility","hidden"),this.hiddenLegendIds=this.mapToIds(this.data.targets))};f.updateLegendWithDefaults=function(){this.updateLegend(this.mapToIds(this.data.targets),{withTransform:!1,withTransitionForTransform:!1,
withTransition:!1})};f.updateSizeForLegend=function(a,b){var e=this.config,f=this.isLegendTop?this.getCurrentPaddingTop()+e.legend_inset_y+5.5:this.currentHeight-a-this.getCurrentPaddingBottom()-e.legend_inset_y,e=this.isLegendLeft?this.getCurrentPaddingLeft()+e.legend_inset_x+.5:this.currentWidth-b-this.getCurrentPaddingRight()-e.legend_inset_x+.5;this.margin3={top:this.isLegendRight?0:this.isLegendInset?f:this.currentHeight-a,right:NaN,bottom:0,left:this.isLegendRight?this.currentWidth-b:this.isLegendInset?
e:0}};f.transformLegend=function(a){(a?this.legend.transition():this.legend).attr("transform",this.getTranslate("legend"))};f.updateLegendStep=function(a){this.legendStep=a};f.updateLegendItemWidth=function(a){this.legendItemWidth=a};f.updateLegendItemHeight=function(a){this.legendItemHeight=a};f.getLegendWidth=function(){return this.config.legend_show?this.isLegendRight||this.isLegendInset?this.legendItemWidth*(this.legendStep+1):this.currentWidth:0};f.getLegendHeight=function(){var a=0;this.config.legend_show&&
(a=this.isLegendRight?this.currentHeight:Math.max(20,this.legendItemHeight)*(this.legendStep+1));return a};f.opacityForLegend=function(a){return a.classed(g.legendItemHidden)?null:1};f.opacityForUnfocusedLegend=function(a){return a.classed(g.legendItemHidden)?null:.3};f.toggleFocusLegend=function(a,b){var e=this;a=e.mapToTargetIds(a);e.legend.selectAll("."+g.legendItem).filter(function(b){return 0<=a.indexOf(b)}).classed(g.legendItemFocused,b).transition().duration(100).style("opacity",function(){return(b?
e.opacityForLegend:e.opacityForUnfocusedLegend).call(e,e.d3.select(this))})};f.revertLegend=function(){var a=this,b=a.d3;a.legend.selectAll("."+g.legendItem).classed(g.legendItemFocused,!1).transition().duration(100).style("opacity",function(){return a.opacityForLegend(b.select(this))})};f.showLegend=function(a){var b=this,e=b.config;e.legend_show||(e.legend_show=!0,b.legend.style("visibility","visible"),b.legendHasRendered||b.updateLegendWithDefaults());b.removeHiddenLegendIds(a);b.legend.selectAll(b.selectorLegends(a)).style("visibility",
"visible").transition().style("opacity",function(){return b.opacityForLegend(b.d3.select(this))})};f.hideLegend=function(a){var b=this.config;b.legend_show&&ba(a)&&(b.legend_show=!1,this.legend.style("visibility","hidden"));this.addHiddenLegendIds(a);this.legend.selectAll(this.selectorLegends(a)).style("opacity",0).style("visibility","hidden")};f.clearLegendItemTextBoxCache=function(){this.legendItemTextBox={}};f.updateLegend=function(a,b,e){function f(a,b){v.legendItemTextBox[b]||(v.legendItemTextBox[b]=
v.getTextRect(a.textContent,g.legendItem));return v.legendItemTextBox[b]}function h(b,e,g){function q(a,b){b||(r=(n-C-m)/2,10>r&&(r=(n-m)/2,C=0,K++));S[a]=K;A[K]=v.isLegendInset?10:r;G[a]=C;C+=m}var t=0===g;g=g===a.length-1;b=f(b,e);g=b.width+15+(!g||v.isLegendRight||v.isLegendInset?10:0);b=b.height+4;var m=v.isLegendRight||v.isLegendInset?b:g,n=v.isLegendRight||v.isLegendInset?v.getLegendHeight():v.getLegendWidth(),r;t&&(I=x=K=C=0);if(p.legend_show&&!v.isLegendToShow(e))P[e]=F[e]=S[e]=G[e]=0;else{P[e]=
g;F[e]=b;if(!x||g>=x)x=g;if(!I||b>=I)I=b;t=v.isLegendRight||v.isLegendInset?I:x;p.legend_equally?(Object.keys(P).forEach(function(a){P[a]=x}),Object.keys(F).forEach(function(a){F[a]=I}),r=(n-t*a.length)/2,10>r?(K=C=0,a.forEach(function(a){q(a)})):q(e,!0)):q(e)}}var v=this,p=v.config,m,t,n,r,u,w,x=0,I=0,M,C=0,G={},P={},F={},A=[0],S={},K=0,B,J;b=b||{};B=H(b,"withTransition",!0);b=H(b,"withTransitionForTransform",!0);v.isLegendInset&&(K=p.legend_inset_step?p.legend_inset_step:a.length,v.updateLegendStep(K));
v.isLegendRight?(m=function(a){return x*S[a]},r=function(a){return A[S[a]]+G[a]}):v.isLegendInset?(m=function(a){return x*S[a]+10},r=function(a){return A[S[a]]+G[a]}):(m=function(a){return A[S[a]]+G[a]},r=function(a){return I*S[a]});t=function(a,b){return m(a,b)+14};u=function(a,b){return r(a,b)+9};n=function(a,b){return m(a,b)};w=function(a,b){return r(a,b)-5};M=v.legend.selectAll("."+g.legendItem).data(a).enter().append("g").attr("class",function(a){return v.generateClass(g.legendItem,a)}).style("visibility",
function(a){return v.isLegendToShow(a)?"visible":"hidden"}).style("cursor","pointer").on("click",function(a){p.legend_item_onclick?p.legend_item_onclick.call(v,a):v.d3.event.altKey?(v.api.hide(),v.api.show(a)):(v.api.toggle(a),v.isTargetToShow(a)?v.api.focus(a):v.api.revert())}).on("mouseover",function(a){v.d3.select(this).classed(g.legendItemFocused,!0);!v.transiting&&v.isTargetToShow(a)&&v.api.focus(a);p.legend_item_onmouseover&&p.legend_item_onmouseover.call(v,a)}).on("mouseout",function(a){v.d3.select(this).classed(g.legendItemFocused,
!1);v.api.revert();p.legend_item_onmouseout&&p.legend_item_onmouseout.call(v,a)});M.append("text").text(function(a){return E(p.data_names[a])?p.data_names[a]:a}).each(function(a,b){h(this,a,b)}).style("pointer-events","none").attr("x",v.isLegendRight||v.isLegendInset?t:-200).attr("y",v.isLegendRight||v.isLegendInset?-200:u);M.append("rect").attr("class",g.legendItemEvent).style("fill-opacity",0).attr("x",v.isLegendRight||v.isLegendInset?n:-200).attr("y",v.isLegendRight||v.isLegendInset?-200:w);M.append("rect").attr("class",
g.legendItemTile).style("pointer-events","none").style("fill",v.color).attr("x",v.isLegendRight||v.isLegendInset?t:-200).attr("y",v.isLegendRight||v.isLegendInset?-200:r).attr("width",10).attr("height",10);M=v.legend.select("."+g.legendBackground+" rect");v.isLegendInset&&0<x&&0===M.size()&&(M=v.legend.insert("g","."+g.legendItem).attr("class",g.legendBackground).append("rect"));J=v.legend.selectAll("text").data(a).text(function(a){return E(p.data_names[a])?p.data_names[a]:a}).each(function(a,b){h(this,
a,b)});(B?J.transition():J).attr("x",t).attr("y",u);t=v.legend.selectAll("rect."+g.legendItemEvent).data(a);(B?t.transition():t).attr("width",function(a){return P[a]}).attr("height",function(a){return F[a]}).attr("x",n).attr("y",w);n=v.legend.selectAll("rect."+g.legendItemTile).data(a);(B?n.transition():n).style("fill",v.color).attr("x",m).attr("y",r);M&&(B?M.transition():M).attr("height",v.getLegendHeight()-12).attr("width",x*(K+1)+10);v.legend.selectAll("."+g.legendItem).classed(g.legendItemHidden,
function(a){return!v.isTargetToShow(a)});v.updateLegendItemWidth(x);v.updateLegendItemHeight(I);v.updateLegendStep(K);v.updateSizes();v.updateScales();v.updateSvgSize();v.transformAll(b,e);v.legendHasRendered=!0};f.initTitle=function(){this.title=this.svg.append("text").text(this.config.title_text).attr("class",this.CLASS.title)};f.redrawTitle=function(){this.title.attr("x",this.xForTitle.bind(this)).attr("y",this.yForTitle.bind(this))};f.xForTitle=function(){var a=this.config,b=a.title_position||
"left";return 0<=b.indexOf("right")?this.currentWidth-this.title.node().getBBox().width-a.title_padding.right:0<=b.indexOf("center")?(this.currentWidth-this.title.node().getBBox().width)/2:a.title_padding.left};f.yForTitle=function(){return this.config.title_padding.top+this.title.node().getBBox().height};f.getTitlePadding=function(){return this.yForTitle()+this.config.title_padding.bottom};(function(a,b){if(Object.create)b.prototype=Object.create(a.prototype);else{var e=function(){};e.prototype=
a.prototype;b.prototype=new e}return b.prototype.constructor=b})(function(a){this.owner=a},m);m.prototype.init=function(){var a=this.owner,b=a.config,e=a.main;a.axes.x=e.append("g").attr("class",g.axis+" "+g.axisX).attr("clip-path",a.clipPathForXAxis).attr("transform",a.getTranslate("x")).style("visibility",b.axis_x_show?"visible":"hidden");a.axes.x.append("text").attr("class",g.axisXLabel).attr("transform",b.axis_rotated?"rotate(-90)":"").style("text-anchor",this.textAnchorForXAxisLabel.bind(this));
a.axes.y=e.append("g").attr("class",g.axis+" "+g.axisY).attr("clip-path",b.axis_y_inner?"":a.clipPathForYAxis).attr("transform",a.getTranslate("y")).style("visibility",b.axis_y_show?"visible":"hidden");a.axes.y.append("text").attr("class",g.axisYLabel).attr("transform",b.axis_rotated?"":"rotate(-90)").style("text-anchor",this.textAnchorForYAxisLabel.bind(this));a.axes.y2=e.append("g").attr("class",g.axis+" "+g.axisY2).attr("transform",a.getTranslate("y2")).style("visibility",b.axis_y2_show?"visible":
"hidden");a.axes.y2.append("text").attr("class",g.axisY2Label).attr("transform",b.axis_rotated?"":"rotate(-90)").style("text-anchor",this.textAnchorForY2AxisLabel.bind(this))};m.prototype.getXAxis=function(a,b,e,f,g,h,p){var m=this.owner,t=m.config;g={isCategory:m.isCategorized(),withOuterTick:g,tickMultiline:t.axis_x_tick_multiline,tickWidth:t.axis_x_tick_width,tickTextRotate:p?0:t.axis_x_tick_rotate,withoutTransition:h};a=x(m.d3,g).scale(a).orient(b);m.isTimeSeries()&&f&&(f=f.map(function(a){return m.parseDate(a)}));
a.tickFormat(e).tickValues(f);m.isCategorized()&&(a.tickCentered(t.axis_x_tick_centered),ba(t.axis_x_tick_culling)&&(t.axis_x_tick_culling=!1));return a};m.prototype.updateXAxisTickValues=function(a,b){var e=this.owner,f=e.config,g;if(f.axis_x_tick_fit||f.axis_x_tick_count)g=this.generateTickValues(e.mapTargetsToUniqueXs(a),f.axis_x_tick_count,e.isTimeSeries());b?b.tickValues(g):(e.xAxis.tickValues(g),e.subXAxis.tickValues(g));return g};m.prototype.getYAxis=function(a,b,e,f,g,h){var p=this.owner,
m=p.d3,t=p.config;a=x(m,{withOuterTick:g,withoutTransition:h}).scale(a).orient(b).tickFormat(e);p.isTimeSeriesY()?a.ticks(m.time[t.axis_y_tick_time_value],t.axis_y_tick_time_interval):a.tickValues(f);return a};m.prototype.getId=function(a){var b=this.owner.config;return a in b.data_axes?b.data_axes[a]:"y"};m.prototype.getXAxisTickFormat=function(){var a=this.owner,b=a.config,e=a.isTimeSeries()?a.defaultAxisTimeFormat:a.isCategorized()?a.categoryName:function(a){return 0>a?a.toFixed(0):a};b.axis_x_tick_format&&
(J(b.axis_x_tick_format)?e=b.axis_x_tick_format:a.isTimeSeries()&&(e=function(e){return e?a.axisTimeFormat(b.axis_x_tick_format)(e):""}));return J(e)?function(b){return e.call(a,b)}:e};m.prototype.getTickValues=function(a,b){return a?a:b?b.tickValues():void 0};m.prototype.getXAxisTickValues=function(){return this.getTickValues(this.owner.config.axis_x_tick_values,this.owner.xAxis)};m.prototype.getYAxisTickValues=function(){return this.getTickValues(this.owner.config.axis_y_tick_values,this.owner.yAxis)};
m.prototype.getY2AxisTickValues=function(){return this.getTickValues(this.owner.config.axis_y2_tick_values,this.owner.y2Axis)};m.prototype.getLabelOptionByAxisId=function(a){var b=this.owner.config,e;"y"===a?e=b.axis_y_label:"y2"===a?e=b.axis_y2_label:"x"===a&&(e=b.axis_x_label);return e};m.prototype.getLabelText=function(a){a=this.getLabelOptionByAxisId(a);return C(a)?a:a?a.text:null};m.prototype.setLabelText=function(a,b){var e=this.owner.config,f=this.getLabelOptionByAxisId(a);C(f)?"y"===a?e.axis_y_label=
b:"y2"===a?e.axis_y2_label=b:"x"===a&&(e.axis_x_label=b):f&&(f.text=b)};m.prototype.getLabelPosition=function(a,b){var e=this.getLabelOptionByAxisId(a),e=e&&"object"===typeof e&&e.position?e.position:b;return{isInner:0<=e.indexOf("inner"),isOuter:0<=e.indexOf("outer"),isLeft:0<=e.indexOf("left"),isCenter:0<=e.indexOf("center"),isRight:0<=e.indexOf("right"),isTop:0<=e.indexOf("top"),isMiddle:0<=e.indexOf("middle"),isBottom:0<=e.indexOf("bottom")}};m.prototype.getXAxisLabelPosition=function(){return this.getLabelPosition("x",
this.owner.config.axis_rotated?"inner-top":"inner-right")};m.prototype.getYAxisLabelPosition=function(){return this.getLabelPosition("y",this.owner.config.axis_rotated?"inner-right":"inner-top")};m.prototype.getY2AxisLabelPosition=function(){return this.getLabelPosition("y2",this.owner.config.axis_rotated?"inner-right":"inner-top")};m.prototype.getLabelPositionById=function(a){return"y2"===a?this.getY2AxisLabelPosition():"y"===a?this.getYAxisLabelPosition():this.getXAxisLabelPosition()};m.prototype.textForXAxisLabel=
function(){return this.getLabelText("x")};m.prototype.textForYAxisLabel=function(){return this.getLabelText("y")};m.prototype.textForY2AxisLabel=function(){return this.getLabelText("y2")};m.prototype.xForAxisLabel=function(a,b){var e=this.owner;return a?b.isLeft?0:b.isCenter?e.width/2:e.width:b.isBottom?-e.height:b.isMiddle?-e.height/2:0};m.prototype.dxForAxisLabel=function(a,b){return a?b.isLeft?"0.5em":b.isRight?"-0.5em":"0":b.isTop?"-0.5em":b.isBottom?"0.5em":"0"};m.prototype.textAnchorForAxisLabel=
function(a,b){return a?b.isLeft?"start":b.isCenter?"middle":"end":b.isBottom?"start":b.isMiddle?"middle":"end"};m.prototype.xForXAxisLabel=function(){return this.xForAxisLabel(!this.owner.config.axis_rotated,this.getXAxisLabelPosition())};m.prototype.xForYAxisLabel=function(){return this.xForAxisLabel(this.owner.config.axis_rotated,this.getYAxisLabelPosition())};m.prototype.xForY2AxisLabel=function(){return this.xForAxisLabel(this.owner.config.axis_rotated,this.getY2AxisLabelPosition())};m.prototype.dxForXAxisLabel=
function(){return this.dxForAxisLabel(!this.owner.config.axis_rotated,this.getXAxisLabelPosition())};m.prototype.dxForYAxisLabel=function(){return this.dxForAxisLabel(this.owner.config.axis_rotated,this.getYAxisLabelPosition())};m.prototype.dxForY2AxisLabel=function(){return this.dxForAxisLabel(this.owner.config.axis_rotated,this.getY2AxisLabelPosition())};m.prototype.dyForXAxisLabel=function(){var a=this.owner.config,b=this.getXAxisLabelPosition();return a.axis_rotated?b.isInner?"1.2em":-25-this.getMaxTickWidth("x"):
b.isInner?"-0.5em":a.axis_x_height?a.axis_x_height-10:"3em"};m.prototype.dyForYAxisLabel=function(){var a=this.owner,b=this.getYAxisLabelPosition();return a.config.axis_rotated?b.isInner?"-0.5em":"3em":b.isInner?"1.2em":-10-(a.config.axis_y_inner?0:this.getMaxTickWidth("y")+10)};m.prototype.dyForY2AxisLabel=function(){var a=this.owner,b=this.getY2AxisLabelPosition();return a.config.axis_rotated?b.isInner?"1.2em":"-2.2em":b.isInner?"-0.5em":15+(a.config.axis_y2_inner?0:this.getMaxTickWidth("y2")+15)};
m.prototype.textAnchorForXAxisLabel=function(){return this.textAnchorForAxisLabel(!this.owner.config.axis_rotated,this.getXAxisLabelPosition())};m.prototype.textAnchorForYAxisLabel=function(){return this.textAnchorForAxisLabel(this.owner.config.axis_rotated,this.getYAxisLabelPosition())};m.prototype.textAnchorForY2AxisLabel=function(){return this.textAnchorForAxisLabel(this.owner.config.axis_rotated,this.getY2AxisLabelPosition())};m.prototype.getMaxTickWidth=function(a,b){var e=this.owner,f=e.config,
g=0,h,p,m;if(b&&e.currentMaxTickWidths[a])return e.currentMaxTickWidths[a];e.svg&&(h=e.filterTargetsToShow(e.data.targets),"y"===a?(p=e.y.copy().domain(e.getYDomain(h,"y")),f=this.getYAxis(p,e.yOrient,f.axis_y_tick_format,e.yAxisTickValues,!1,!0)):"y2"===a?(p=e.y2.copy().domain(e.getYDomain(h,"y2")),f=this.getYAxis(p,e.y2Orient,f.axis_y2_tick_format,e.y2AxisTickValues,!1,!0)):(p=e.x.copy().domain(e.getXDomain(h)),f=this.getXAxis(p,e.xOrient,e.xAxisTickFormat,e.xAxisTickValues,!1,!0,!0),this.updateXAxisTickValues(h,
f)),m=e.d3.select("body").append("div").classed("c3",!0),h=m.append("svg").style("visibility","hidden").style("position","fixed").style("top",0).style("left",0),h.append("g").call(f).each(function(){e.d3.select(this).selectAll("text").each(function(){var a=this.getBoundingClientRect();g<a.width&&(g=a.width)});m.remove()}));e.currentMaxTickWidths[a]=0>=g?e.currentMaxTickWidths[a]:g;return e.currentMaxTickWidths[a]};m.prototype.updateLabels=function(a){var b=this.owner,e=b.main.select("."+g.axisX+" ."+
g.axisXLabel),f=b.main.select("."+g.axisY+" ."+g.axisYLabel),b=b.main.select("."+g.axisY2+" ."+g.axisY2Label);(a?e.transition():e).attr("x",this.xForXAxisLabel.bind(this)).attr("dx",this.dxForXAxisLabel.bind(this)).attr("dy",this.dyForXAxisLabel.bind(this)).text(this.textForXAxisLabel.bind(this));(a?f.transition():f).attr("x",this.xForYAxisLabel.bind(this)).attr("dx",this.dxForYAxisLabel.bind(this)).attr("dy",this.dyForYAxisLabel.bind(this)).text(this.textForYAxisLabel.bind(this));(a?b.transition():
b).attr("x",this.xForY2AxisLabel.bind(this)).attr("dx",this.dxForY2AxisLabel.bind(this)).attr("dy",this.dyForY2AxisLabel.bind(this)).text(this.textForY2AxisLabel.bind(this))};m.prototype.getPadding=function(a,b,e,f){return w(a[b])?"ratio"===a.unit?a[b]*f:this.convertPixelsToAxisPadding(a[b],f):e};m.prototype.convertPixelsToAxisPadding=function(a,b){var e=this.owner;return a/(e.config.axis_rotated?e.width:e.height)*b};m.prototype.generateTickValues=function(a,b,e){var f=a,g,h,p,m;if(b)if(b=J(b)?b():
b,1===b)f=[a[0]];else if(2===b)f=[a[0],a[a.length-1]];else if(2<b){g=b-2;b=a[0];a=a[a.length-1];h=(a-b)/(g+1);f=[b];for(p=0;p<g;p++)m=+b+h*(p+1),f.push(e?new Date(m):m);f.push(a)}e||(f=f.sort(function(a,b){return a-b}));return f};m.prototype.generateTransitions=function(a){var b=this.owner.axes;return{axisX:a?b.x.transition().duration(a):b.x,axisY:a?b.y.transition().duration(a):b.y,axisY2:a?b.y2.transition().duration(a):b.y2,axisSubX:a?b.subx.transition().duration(a):b.subx}};m.prototype.redraw=function(a,
b){var e=this.owner;e.axes.x.style("opacity",b?0:1);e.axes.y.style("opacity",b?0:1);e.axes.y2.style("opacity",b?0:1);e.axes.subx.style("opacity",b?0:1);a.axisX.call(e.xAxis);a.axisY.call(e.yAxis);a.axisY2.call(e.y2Axis);a.axisSubX.call(e.subXAxis)};f.getClipPath=function(a){return"url("+(0<=h.navigator.appVersion.toLowerCase().indexOf("msie 9.")?"":document.URL.split("#")[0])+"#"+a+")"};f.appendClip=function(a,b){return a.append("clipPath").attr("id",b).append("rect")};f.getAxisClipX=function(a){var b=
Math.max(30,this.margin.left);return a?-(1+b):-(b-1)};f.getAxisClipY=function(a){return a?-20:-this.margin.top};f.getXAxisClipX=function(){return this.getAxisClipX(!this.config.axis_rotated)};f.getXAxisClipY=function(){return this.getAxisClipY(!this.config.axis_rotated)};f.getYAxisClipX=function(){return this.config.axis_y_inner?-1:this.getAxisClipX(this.config.axis_rotated)};f.getYAxisClipY=function(){return this.getAxisClipY(this.config.axis_rotated)};f.getAxisClipWidth=function(a){var b=Math.max(30,
this.margin.left),e=Math.max(30,this.margin.right);return a?this.width+2+b+e:this.margin.left+20};f.getAxisClipHeight=function(a){return(a?this.margin.bottom:this.margin.top+this.height)+20};f.getXAxisClipWidth=function(){return this.getAxisClipWidth(!this.config.axis_rotated)};f.getXAxisClipHeight=function(){return this.getAxisClipHeight(!this.config.axis_rotated)};f.getYAxisClipWidth=function(){return this.getAxisClipWidth(this.config.axis_rotated)+(this.config.axis_y_inner?20:0)};f.getYAxisClipHeight=
function(){return this.getAxisClipHeight(this.config.axis_rotated)};f.initPie=function(){var a=this.config;this.pie=this.d3.layout.pie().value(function(a){return a.values.reduce(function(a,b){return a+b.value},0)});a.data_order||this.pie.sort(null)};f.updateRadius=function(){var a=this.config,a=a.gauge_width||a.donut_width;this.radiusExpanded=Math.min(this.arcWidth,this.arcHeight)/2;this.radius=.95*this.radiusExpanded;this.innerRadiusRatio=a?(this.radius-a)/this.radius:.6;this.innerRadius=this.hasType("donut")||
this.hasType("gauge")?this.radius*this.innerRadiusRatio:0};f.updateArc=function(){this.svgArc=this.getSvgArc();this.svgArcExpanded=this.getSvgArcExpanded();this.svgArcExpandedSub=this.getSvgArcExpanded(.98)};f.updateAngle=function(a){var b=this.config,e=!1,f=0,g=b.gauge_min,h=b.gauge_max;this.pie(this.filterTargetsToShow(this.data.targets)).forEach(function(b){e||b.data.id!==a.data.id||(e=!0,a=b,a.index=f);f++});isNaN(a.startAngle)&&(a.startAngle=0);isNaN(a.endAngle)&&(a.endAngle=a.startAngle);this.isGaugeType(a.data)&&
(b=Math.PI/(h-g),g=a.value<g?0:a.value<h?a.value-g:h-g,a.startAngle=Math.PI/2*-1,a.endAngle=a.startAngle+b*g);return e?a:null};f.getSvgArc=function(){var a=this,b=a.d3.svg.arc().outerRadius(a.radius).innerRadius(a.innerRadius),e=function(e,f){var g;return f?b(e):(g=a.updateAngle(e))?b(g):"M 0 0"};e.centroid=b.centroid;return e};f.getSvgArcExpanded=function(a){var b=this,e=b.d3.svg.arc().outerRadius(b.radiusExpanded*(a?a:1)).innerRadius(b.innerRadius);return function(a){return(a=b.updateAngle(a))?
e(a):"M 0 0"}};f.getArc=function(a,b,e){return e||this.isArcType(a.data)?this.svgArc(a,b):"M 0 0"};f.transformForArcLabel=function(a){a=this.updateAngle(a);var b,e;b="";a&&!this.hasType("gauge")&&(b=this.svgArc.centroid(a),a=isNaN(b[0])?0:b[0],b=isNaN(b[1])?0:b[1],e=Math.sqrt(a*a+b*b),e=this.radius&&e?(.375<36/this.radius?1.175-36/this.radius:.8)*this.radius/e:0,b="translate("+a*e+","+b*e+")");return b};f.getArcRatio=function(a){var b=this.hasType("gauge")?Math.PI:2*Math.PI;return a?(a.endAngle-a.startAngle)/
b:null};f.convertToArcData=function(a){return this.addName({id:a.data.id,value:a.value,ratio:this.getArcRatio(a),index:a.index})};f.textForArcLabel=function(a){var b,e,f;if(!this.shouldShowArcLabel())return"";e=(b=this.updateAngle(a))?b.value:null;b=this.getArcRatio(b);a=a.data.id;return this.hasType("gauge")||this.meetsArcLabelThreshold(b)?(f=this.getArcLabelFormat())?f(e,b,a):this.defaultArcValueFormat(e,b):""};f.expandArc=function(a){var b=this,e;b.transiting?e=h.setInterval(function(){b.transiting||
(h.clearInterval(e),0<b.legend.selectAll(".c3-legend-item-focused").size()&&b.expandArc(a))},10):(a=b.mapToTargetIds(a),b.svg.selectAll(b.selectorTargets(a,"."+g.chartArc)).each(function(a){b.shouldExpand(a.data.id)&&b.d3.select(this).selectAll("path").transition().duration(50).attr("d",b.svgArcExpanded).transition().duration(100).attr("d",b.svgArcExpandedSub).each(function(a){b.isDonutType(a.data)})}))};f.unexpandArc=function(a){this.transiting||(a=this.mapToTargetIds(a),this.svg.selectAll(this.selectorTargets(a,
"."+g.chartArc)).selectAll("path").transition().duration(50).attr("d",this.svgArc),this.svg.selectAll("."+g.arc).style("opacity",1))};f.shouldExpand=function(a){var b=this.config;return this.isDonutType(a)&&b.donut_expand||this.isGaugeType(a)&&b.gauge_expand||this.isPieType(a)&&b.pie_expand};f.shouldShowArcLabel=function(){var a=this.config,b=!0;this.hasType("donut")?b=a.donut_label_show:this.hasType("pie")&&(b=a.pie_label_show);return b};f.meetsArcLabelThreshold=function(a){var b=this.config,b=this.hasType("donut")?
b.donut_label_threshold:b.pie_label_threshold;return a>=b};f.getArcLabelFormat=function(){var a=this.config,b=a.pie_label_format;this.hasType("gauge")?b=a.gauge_label_format:this.hasType("donut")&&(b=a.donut_label_format);return b};f.getArcTitle=function(){return this.hasType("donut")?this.config.donut_title:""};f.updateTargetsForArc=function(a){var b=this.main,e=this.classChartArc.bind(this),f=this.classArcs.bind(this),h=this.classFocus.bind(this);a=b.select("."+g.chartArcs).selectAll("."+g.chartArc).data(this.pie(a)).attr("class",
function(a){return e(a)+h(a.data)}).enter().append("g").attr("class",e);a.append("g").attr("class",f);a.append("text").attr("dy",this.hasType("gauge")?"-.1em":".35em").style("opacity",0).style("text-anchor","middle").style("pointer-events","none")};f.initArc=function(){this.arcs=this.main.select("."+g.chart).append("g").attr("class",g.chartArcs).attr("transform",this.getTranslate("arc"));this.arcs.append("text").attr("class",g.chartArcsTitle).style("text-anchor","middle").text(this.getArcTitle())};
f.redrawArc=function(a,b,e){var f=this,h=f.d3,m=f.config,p=f.main,n;n=p.selectAll("."+g.arcs).selectAll("."+g.arc).data(f.arcData.bind(f));n.enter().append("path").attr("class",f.classArc.bind(f)).style("fill",function(a){return f.color(a.data)}).style("cursor",function(a){return m.interaction_enabled&&m.data_selection_isselectable(a)?"pointer":null}).style("opacity",0).each(function(a){f.isGaugeType(a.data)&&(a.startAngle=a.endAngle=Math.PI/2*-1);this._current=a});n.attr("transform",function(a){return!f.isGaugeType(a.data)&&
e?"scale(0)":""}).style("opacity",function(a){return a===this._current?0:1}).on("mouseover",m.interaction_enabled?function(a){var b;f.transiting||(a=f.updateAngle(a),b=f.convertToArcData(a),f.expandArc(a.data.id),f.api.focus(a.data.id),f.toggleFocusLegend(a.data.id,!0),f.config.data_onmouseover(b,this))}:null).on("mousemove",m.interaction_enabled?function(a){a=f.updateAngle(a);a=[f.convertToArcData(a)];f.showTooltip(a,this)}:null).on("mouseout",m.interaction_enabled?function(a){var b;f.transiting||
(a=f.updateAngle(a),b=f.convertToArcData(a),f.unexpandArc(a.data.id),f.api.revert(),f.revertLegend(),f.hideTooltip(),f.config.data_onmouseout(b,this))}:null).on("click",m.interaction_enabled?function(a,b){var e=f.updateAngle(a),e=f.convertToArcData(e);f.toggleShape&&f.toggleShape(this,e,b);f.config.data_onclick.call(f.api,e,this)}:null).each(function(){f.transiting=!0}).transition().duration(a).attrTween("d",function(a){var b=f.updateAngle(a),e;if(!b)return function(){return"M 0 0"};isNaN(this._current.startAngle)&&
(this._current.startAngle=0);isNaN(this._current.endAngle)&&(this._current.endAngle=this._current.startAngle);e=h.interpolate(this._current,b);this._current=e(0);return function(b){b=e(b);b.data=a.data;return f.getArc(b,!0)}}).attr("transform",e?"scale(1)":"").style("fill",function(a){return f.levelColor?f.levelColor(a.data.values[0].value):f.color(a.data.id)}).style("opacity",1).call(f.endall,function(){f.transiting=!1});n.exit().transition().duration(b).style("opacity",0).remove();p.selectAll("."+
g.chartArc).select("text").style("opacity",0).attr("class",function(a){return f.isGaugeType(a.data)?g.gaugeValue:""}).text(f.textForArcLabel.bind(f)).attr("transform",f.transformForArcLabel.bind(f)).style("font-size",function(a){return f.isGaugeType(a.data)?Math.round(f.radius/5)+"px":""}).transition().duration(a).style("opacity",function(a){return f.isTargetToShow(a.data.id)&&f.isArcType(a.data)?1:0});p.select("."+g.chartArcsTitle).style("opacity",f.hasType("donut")||f.hasType("gauge")?1:0);f.hasType("gauge")&&
(f.arcs.select("."+g.chartArcsBackground).attr("d",function(){return f.getArc({data:[{value:m.gauge_max}],startAngle:Math.PI/2*-1,endAngle:Math.PI/2},!0,!0)}),f.arcs.select("."+g.chartArcsGaugeUnit).attr("dy",".75em").text(m.gauge_label_show?m.gauge_units:""),f.arcs.select("."+g.chartArcsGaugeMin).attr("dx",-1*(f.innerRadius+(f.radius-f.innerRadius)/2)+"px").attr("dy","1.2em").text(m.gauge_label_show?m.gauge_min:""),f.arcs.select("."+g.chartArcsGaugeMax).attr("dx",f.innerRadius+(f.radius-f.innerRadius)/
2+"px").attr("dy","1.2em").text(m.gauge_label_show?m.gauge_max:""))};f.initGauge=function(){var a=this.arcs;this.hasType("gauge")&&(a.append("path").attr("class",g.chartArcsBackground),a.append("text").attr("class",g.chartArcsGaugeUnit).style("text-anchor","middle").style("pointer-events","none"),a.append("text").attr("class",g.chartArcsGaugeMin).style("text-anchor","middle").style("pointer-events","none"),a.append("text").attr("class",g.chartArcsGaugeMax).style("text-anchor","middle").style("pointer-events",
"none"))};f.getGaugeLabelHeight=function(){return this.config.gauge_label_show?20:0};f.initRegion=function(){this.region=this.main.append("g").attr("clip-path",this.clipPath).attr("class",g.regions)};f.updateRegion=function(a){var b=this.config;this.region.style("visibility",this.hasArcType()?"hidden":"visible");this.mainRegion=this.main.select("."+g.regions).selectAll("."+g.region).data(b.regions);this.mainRegion.enter().append("g").attr("class",this.classRegion.bind(this)).append("rect").style("fill-opacity",
0);this.mainRegion.exit().transition().duration(a).style("opacity",0).remove()};f.redrawRegion=function(a){var b=this.mainRegion.selectAll("rect"),e=this.regionX.bind(this),f=this.regionY.bind(this),g=this.regionWidth.bind(this),h=this.regionHeight.bind(this);return[(a?b.transition():b).attr("x",e).attr("y",f).attr("width",g).attr("height",h).style("fill-opacity",function(a){return w(a.opacity)?a.opacity:.1})]};f.regionX=function(a){var b=this.config,e="y"===a.axis?this.y:this.y2;return"y"===a.axis||
"y2"===a.axis?b.axis_rotated?"start"in a?e(a.start):0:0:b.axis_rotated?0:"start"in a?this.x(this.isTimeSeries()?this.parseDate(a.start):a.start):0};f.regionY=function(a){var b=this.config,e="y"===a.axis?this.y:this.y2;return"y"===a.axis||"y2"===a.axis?b.axis_rotated?0:"end"in a?e(a.end):0:b.axis_rotated?"start"in a?this.x(this.isTimeSeries()?this.parseDate(a.start):a.start):0:0};f.regionWidth=function(a){var b=this.config,e=this.regionX(a),f="y"===a.axis?this.y:this.y2;a="y"===a.axis||"y2"===a.axis?
b.axis_rotated?"end"in a?f(a.end):this.width:this.width:b.axis_rotated?this.width:"end"in a?this.x(this.isTimeSeries()?this.parseDate(a.end):a.end):this.width;return a<e?0:a-e};f.regionHeight=function(a){var b=this.config,e=this.regionY(a),f="y"===a.axis?this.y:this.y2;a="y"===a.axis||"y2"===a.axis?b.axis_rotated?this.height:"start"in a?f(a.start):this.height:b.axis_rotated?"end"in a?this.x(this.isTimeSeries()?this.parseDate(a.end):a.end):this.height:this.height;return a<e?0:a-e};f.isRegionOnX=function(a){return!a.axis||
"x"===a.axis};f.drag=function(a){var b=this,e=b.config,f=b.main,h=b.d3,m,p,n,t,r,u,w;b.hasArcType()||!e.data_selection_enabled||e.zoom_enabled&&!b.zoom.altDomain||!e.data_selection_multiple||(m=b.dragStart[0],p=b.dragStart[1],n=a[0],a=a[1],t=Math.min(m,n),r=Math.max(m,n),u=e.data_selection_grouped?b.margin.top:Math.min(p,a),w=e.data_selection_grouped?b.height:Math.max(p,a),f.select("."+g.dragarea).attr("x",t).attr("y",u).attr("width",r-t).attr("height",w-u),f.selectAll("."+g.shapes).selectAll("."+
g.shape).filter(function(a){return e.data_selection_isselectable(a)}).each(function(a,e){var f=h.select(this),l=f.classed(g.SELECTED),p=f.classed(g.INCLUDED),m,n,v,U,x;m=!1;if(f.classed(g.circle))m=1*f.attr("cx"),n=1*f.attr("cy"),x=b.togglePoint,m=t<m&&m<r&&u<n&&n<w;else if(f.classed(g.bar))x=ja(this),m=x.x,n=x.y,v=x.width,U=x.height,x=b.togglePath,m=!(r<m||m+v<t)&&!(w<n||n+U<u);else return;m^p&&(f.classed(g.INCLUDED,!p),f.classed(g.SELECTED,!l),x.call(b,!l,f,a,e))}))};f.dragstart=function(a){var b=
this.config;!this.hasArcType()&&b.data_selection_enabled&&(this.dragStart=a,this.main.select("."+g.chart).append("rect").attr("class",g.dragarea).style("opacity",.1),this.dragging=!0)};f.dragend=function(){var a=this.config;!this.hasArcType()&&a.data_selection_enabled&&(this.main.select("."+g.dragarea).transition().duration(100).style("opacity",0).remove(),this.main.selectAll("."+g.shape).classed(g.INCLUDED,!1),this.dragging=!1)};f.selectPoint=function(a,b,e){var f=this,h=f.config,m=(h.axis_rotated?
f.circleY:f.circleX).bind(f),p=(h.axis_rotated?f.circleX:f.circleY).bind(f),n=f.pointSelectR.bind(f);h.data_onselected.call(f.api,b,a.node());f.main.select("."+g.selectedCircles+f.getTargetSelectorSuffix(b.id)).selectAll("."+g.selectedCircle+"-"+e).data([b]).enter().append("circle").attr("class",function(){return f.generateClass(g.selectedCircle,e)}).attr("cx",m).attr("cy",p).attr("stroke",function(){return f.color(b)}).attr("r",function(a){return 1.4*f.pointSelectR(a)}).transition().duration(100).attr("r",
n)};f.unselectPoint=function(a,b,e){this.config.data_onunselected(b,a.node());this.main.select("."+g.selectedCircles+this.getTargetSelectorSuffix(b.id)).selectAll("."+g.selectedCircle+"-"+e).transition().duration(100).attr("r",0).remove()};f.togglePoint=function(a,b,e,f){a?this.selectPoint(b,e,f):this.unselectPoint(b,e,f)};f.selectPath=function(a,b){var e=this;e.config.data_onselected.call(e,b,a.node());a.transition().duration(100).style("fill",function(){return e.d3.rgb(e.color(b)).brighter(.75)})};
f.unselectPath=function(a,b){var e=this;e.config.data_onunselected.call(e,b,a.node());a.transition().duration(100).style("fill",function(){return e.color(b)})};f.togglePath=function(a,b,e,f){a?this.selectPath(b,e,f):this.unselectPath(b,e,f)};f.getToggle=function(a,b){var e;"circle"===a.nodeName?e=this.isStepType(b)?function(){}:this.togglePoint:"path"===a.nodeName&&(e=this.togglePath);return e};f.toggleShape=function(a,b,e){var f=this.d3,h=this.config,m=f.select(a),p=m.classed(g.SELECTED),n=this.getToggle(a,
b).bind(this);h.data_selection_enabled&&h.data_selection_isselectable(b)&&(h.data_selection_multiple||this.main.selectAll("."+g.shapes+(h.data_selection_grouped?this.getTargetSelectorSuffix(b.id):"")).selectAll("."+g.shape).each(function(a,b){var e=f.select(this);e.classed(g.SELECTED)&&n(!1,e.classed(g.SELECTED,!1),a,b)}),m.classed(g.SELECTED,!p),n(!p,m,b,e))};f.initBrush=function(){var a=this;a.brush=a.d3.svg.brush().on("brush",function(){a.redrawForBrush()});a.brush.update=function(){a.context&&
a.context.select("."+g.brush).call(this);return this};a.brush.scale=function(b){return a.config.axis_rotated?this.y(b):this.x(b)}};f.initSubchart=function(){var a=this.config,b=this.context=this.svg.append("g").attr("transform",this.getTranslate("context"));b.style("visibility",a.subchart_show?"visible":"hidden");b.append("g").attr("clip-path",this.clipPathForSubchart).attr("class",g.chart);b.select("."+g.chart).append("g").attr("class",g.chartBars);b.select("."+g.chart).append("g").attr("class",
g.chartLines);b.append("g").attr("clip-path",this.clipPath).attr("class",g.brush).call(this.brush);this.axes.subx=b.append("g").attr("class",g.axisX).attr("transform",this.getTranslate("subx")).attr("clip-path",a.axis_rotated?"":this.clipPathForXAxis)};f.updateTargetsForSubchart=function(a){var b=this.context,e=this.config,f,h,m=this.classChartBar.bind(this),p=this.classBars.bind(this);f=this.classChartLine.bind(this);var n=this.classLines.bind(this),t=this.classAreas.bind(this);e.subchart_show&&
(h=b.select("."+g.chartBars).selectAll("."+g.chartBar).data(a).attr("class",m),h=h.enter().append("g").style("opacity",0).attr("class",m),h.append("g").attr("class",p),a=b.select("."+g.chartLines).selectAll("."+g.chartLine).data(a).attr("class",f),f=a.enter().append("g").style("opacity",0).attr("class",f),f.append("g").attr("class",n),f.append("g").attr("class",t),b.selectAll("."+g.brush+" rect").attr(e.axis_rotated?"width":"height",e.axis_rotated?this.width2:this.height2))};f.updateBarForSubchart=
function(a){this.contextBar=this.context.selectAll("."+g.bars).selectAll("."+g.bar).data(this.barData.bind(this));this.contextBar.enter().append("path").attr("class",this.classBar.bind(this)).style("stroke","none").style("fill",this.color);this.contextBar.style("opacity",this.initialOpacity.bind(this));this.contextBar.exit().transition().duration(a).style("opacity",0).remove()};f.redrawBarForSubchart=function(a,b,e){(b?this.contextBar.transition().duration(e):this.contextBar).attr("d",a).style("opacity",
1)};f.updateLineForSubchart=function(a){this.contextLine=this.context.selectAll("."+g.lines).selectAll("."+g.line).data(this.lineData.bind(this));this.contextLine.enter().append("path").attr("class",this.classLine.bind(this)).style("stroke",this.color);this.contextLine.style("opacity",this.initialOpacity.bind(this));this.contextLine.exit().transition().duration(a).style("opacity",0).remove()};f.redrawLineForSubchart=function(a,b,e){(b?this.contextLine.transition().duration(e):this.contextLine).attr("d",
a).style("opacity",1)};f.updateAreaForSubchart=function(a){var b=this,e=b.d3;b.contextArea=b.context.selectAll("."+g.areas).selectAll("."+g.area).data(b.lineData.bind(b));b.contextArea.enter().append("path").attr("class",b.classArea.bind(b)).style("fill",b.color).style("opacity",function(){b.orgAreaOpacity=+e.select(this).style("opacity");return 0});b.contextArea.style("opacity",0);b.contextArea.exit().transition().duration(a).style("opacity",0).remove()};f.redrawAreaForSubchart=function(a,b,e){(b?
this.contextArea.transition().duration(e):this.contextArea).attr("d",a).style("fill",this.color).style("opacity",this.orgAreaOpacity)};f.redrawSubchart=function(a,b,e,f,g,h,m){b=this.d3;f=this.config;this.context.style("visibility",f.subchart_show?"visible":"hidden");f.subchart_show&&(b.event&&"zoom"===b.event.type&&this.brush.extent(this.x.orgDomain()).update(),a&&(this.brush.empty()||this.brush.extent(this.x.orgDomain()).update(),a=this.generateDrawArea(g,!0),h=this.generateDrawBar(h,!0),m=this.generateDrawLine(m,
!0),this.updateBarForSubchart(e),this.updateLineForSubchart(e),this.updateAreaForSubchart(e),this.redrawBarForSubchart(h,e,e),this.redrawLineForSubchart(m,e,e),this.redrawAreaForSubchart(a,e,e)))};f.redrawForBrush=function(){var a=this.x;this.redraw({withTransition:!1,withY:this.config.zoom_rescale,withSubchart:!1,withUpdateXDomain:!0,withDimension:!1});this.config.subchart_onbrush.call(this.api,a.orgDomain())};f.transformContext=function(a,b){var e;b&&b.axisSubX?e=b.axisSubX:(e=this.context.select("."+
g.axisX),a&&(e=e.transition()));this.context.attr("transform",this.getTranslate("context"));e.attr("transform",this.getTranslate("subx"))};f.getDefaultExtent=function(){var a=this.config,a=J(a.axis_x_extent)?a.axis_x_extent(this.getXDomain(this.data.targets)):a.axis_x_extent;this.isTimeSeries()&&(a=[this.parseDate(a[0]),this.parseDate(a[1])]);return a};f.initZoom=function(){var a=this,b=a.d3,e=a.config,f;a.zoom=b.behavior.zoom().on("zoomstart",function(){f=b.event.sourceEvent;a.zoom.altDomain=b.event.sourceEvent.altKey?
a.x.orgDomain():null;e.zoom_onzoomstart.call(a.api,b.event.sourceEvent)}).on("zoom",function(){a.redrawForZoom.call(a)}).on("zoomend",function(){var g=b.event.sourceEvent;g&&f.clientX===g.clientX&&f.clientY===g.clientY||(a.redrawEventRect(),a.updateZoom(),e.zoom_onzoomend.call(a.api,a.x.orgDomain()))});a.zoom.scale=function(a){return e.axis_rotated?this.y(a):this.x(a)};a.zoom.orgScaleExtent=function(){var b=e.zoom_extent?e.zoom_extent:[1,10];return[b[0],Math.max(a.getMaxDataCount()/b[1],b[1])]};a.zoom.updateScaleExtent=
function(){var b=T(a.x.orgDomain())/T(a.orgXDomain),e=this.orgScaleExtent();this.scaleExtent([e[0]*b,e[1]*b]);return this}};f.updateZoom=function(){var a=this.config.zoom_enabled?this.zoom:function(){};this.main.select("."+g.zoomRect).call(a).on("dblclick.zoom",null);this.main.selectAll("."+g.eventRect).call(a).on("dblclick.zoom",null)};f.redrawForZoom=function(){var a=this.d3,b=this.config,e=this.zoom,f=this.x;b.zoom_enabled&&0!==this.filterTargetsToShow(this.data.targets).length&&("mousemove"===
a.event.sourceEvent.type&&e.altDomain?(f.domain(e.altDomain),e.scale(f).updateScaleExtent()):(this.isCategorized()&&f.orgDomain()[0]===this.orgXDomain[0]&&f.domain([this.orgXDomain[0]-1E-10,f.orgDomain()[1]]),this.redraw({withTransition:!1,withY:b.zoom_rescale,withSubchart:!1,withEventRect:!1,withDimension:!1}),"mousemove"===a.event.sourceEvent.type&&(this.cancelClick=!0),b.zoom_onzoom.call(this.api,f.orgDomain())))};f.generateColor=function(){var a=this.config,b=this.d3,e=a.data_colors,f=A(a.color_pattern)?
a.color_pattern:b.scale.category10().range(),g=a.data_color,h=[];return function(a){var b=a.id||a.data&&a.data.id||a,m;e[b]instanceof Function?m=e[b](a):e[b]?m=e[b]:(0>h.indexOf(b)&&h.push(b),m=f[h.indexOf(b)%f.length],e[b]=m);return g instanceof Function?g(m,a):m}};f.generateLevelColor=function(){var a=this.config,b=a.color_pattern,e=a.color_threshold,f="value"===e.unit,g=e.values&&e.values.length?e.values:[],h=e.max||100;return A(a.color_threshold)?function(a){var e,m,n=b[b.length-1];for(e=0;e<
g.length;e++)if(m=f?a:100*a/h,m<g[e]){n=b[e];break}return n}:null};f.getYFormat=function(a){var b=this,e=a&&!b.hasType("gauge")?b.defaultArcValueFormat:b.yFormat,f=a&&!b.hasType("gauge")?b.defaultArcValueFormat:b.y2Format;return function(a,g,h){return("y2"===b.axis.getId(h)?f:e).call(b,a,g)}};f.yFormat=function(a){var b=this.config;return(b.axis_y_tick_format?b.axis_y_tick_format:this.defaultValueFormat)(a)};f.y2Format=function(a){var b=this.config;return(b.axis_y2_tick_format?b.axis_y2_tick_format:
this.defaultValueFormat)(a)};f.defaultValueFormat=function(a){return w(a)?+a:""};f.defaultArcValueFormat=function(a,b){return(100*b).toFixed(1)+"%"};f.dataLabelFormat=function(a){var b=this.config.data_labels,e=function(a){return w(a)?+a:""};return"function"===typeof b.format?b.format:"object"===typeof b.format?b.format[a]?!0===b.format[a]?e:b.format[a]:function(){return""}:e};f.hasCaches=function(a){for(var b=0;b<a.length;b++)if(!(a[b]in this.cache))return!1;return!0};f.addCache=function(a,b){this.cache[a]=
this.cloneTarget(b)};f.getCaches=function(a){var b=[],e;for(e=0;e<a.length;e++)a[e]in this.cache&&b.push(this.cloneTarget(this.cache[a[e]]));return b};var g=f.CLASS={target:"c3-target",chart:"c3-chart",chartLine:"c3-chart-line",chartLines:"c3-chart-lines",chartBar:"c3-chart-bar",chartBars:"c3-chart-bars",chartText:"c3-chart-text",chartTexts:"c3-chart-texts",chartArc:"c3-chart-arc",chartArcs:"c3-chart-arcs",chartArcsTitle:"c3-chart-arcs-title",chartArcsBackground:"c3-chart-arcs-background",chartArcsGaugeUnit:"c3-chart-arcs-gauge-unit",
chartArcsGaugeMax:"c3-chart-arcs-gauge-max",chartArcsGaugeMin:"c3-chart-arcs-gauge-min",selectedCircle:"c3-selected-circle",selectedCircles:"c3-selected-circles",eventRect:"c3-event-rect",eventRects:"c3-event-rects",eventRectsSingle:"c3-event-rects-single",eventRectsMultiple:"c3-event-rects-multiple",zoomRect:"c3-zoom-rect",brush:"c3-brush",focused:"c3-focused",defocused:"c3-defocused",region:"c3-region",regions:"c3-regions",title:"c3-title",tooltipContainer:"c3-tooltip-container",tooltip:"c3-tooltip",
tooltipName:"c3-tooltip-name",shape:"c3-shape",shapes:"c3-shapes",line:"c3-line",lines:"c3-lines",bar:"c3-bar",bars:"c3-bars",circle:"c3-circle",circles:"c3-circles",arc:"c3-arc",arcs:"c3-arcs",area:"c3-area",areas:"c3-areas",empty:"c3-empty",text:"c3-text",texts:"c3-texts",gaugeValue:"c3-gauge-value",grid:"c3-grid",gridLines:"c3-grid-lines",xgrid:"c3-xgrid",xgrids:"c3-xgrids",xgridLine:"c3-xgrid-line",xgridLines:"c3-xgrid-lines",xgridFocus:"c3-xgrid-focus",ygrid:"c3-ygrid",ygrids:"c3-ygrids",ygridLine:"c3-ygrid-line",
ygridLines:"c3-ygrid-lines",axis:"c3-axis",axisX:"c3-axis-x",axisXLabel:"c3-axis-x-label",axisY:"c3-axis-y",axisYLabel:"c3-axis-y-label",axisY2:"c3-axis-y2",axisY2Label:"c3-axis-y2-label",legendBackground:"c3-legend-background",legendItem:"c3-legend-item",legendItemEvent:"c3-legend-item-event",legendItemTile:"c3-legend-item-tile",legendItemHidden:"c3-legend-item-hidden",legendItemFocused:"c3-legend-item-focused",dragarea:"c3-dragarea",EXPANDED:"_expanded_",SELECTED:"_selected_",INCLUDED:"_included_"};
f.generateClass=function(a,b){return" "+a+" "+a+this.getTargetSelectorSuffix(b)};f.classText=function(a){return this.generateClass(g.text,a.index)};f.classTexts=function(a){return this.generateClass(g.texts,a.id)};f.classShape=function(a){return this.generateClass(g.shape,a.index)};f.classShapes=function(a){return this.generateClass(g.shapes,a.id)};f.classLine=function(a){return this.classShape(a)+this.generateClass(g.line,a.id)};f.classLines=function(a){return this.classShapes(a)+this.generateClass(g.lines,
a.id)};f.classCircle=function(a){return this.classShape(a)+this.generateClass(g.circle,a.index)};f.classCircles=function(a){return this.classShapes(a)+this.generateClass(g.circles,a.id)};f.classBar=function(a){return this.classShape(a)+this.generateClass(g.bar,a.index)};f.classBars=function(a){return this.classShapes(a)+this.generateClass(g.bars,a.id)};f.classArc=function(a){return this.classShape(a.data)+this.generateClass(g.arc,a.data.id)};f.classArcs=function(a){return this.classShapes(a.data)+
this.generateClass(g.arcs,a.data.id)};f.classArea=function(a){return this.classShape(a)+this.generateClass(g.area,a.id)};f.classAreas=function(a){return this.classShapes(a)+this.generateClass(g.areas,a.id)};f.classRegion=function(a,b){return this.generateClass(g.region,b)+" "+("class"in a?a["class"]:"")};f.classEvent=function(a){return this.generateClass(g.eventRect,a.index)};f.classTarget=function(a){var b=this.config.data_classes[a],e="";b&&(e=" "+g.target+"-"+b);return this.generateClass(g.target,
a)+e};f.classFocus=function(a){return this.classFocused(a)+this.classDefocused(a)};f.classFocused=function(a){return" "+(0<=this.focusedTargetIds.indexOf(a.id)?g.focused:"")};f.classDefocused=function(a){return" "+(0<=this.defocusedTargetIds.indexOf(a.id)?g.defocused:"")};f.classChartText=function(a){return g.chartText+this.classTarget(a.id)};f.classChartLine=function(a){return g.chartLine+this.classTarget(a.id)};f.classChartBar=function(a){return g.chartBar+this.classTarget(a.id)};f.classChartArc=
function(a){return g.chartArc+this.classTarget(a.data.id)};f.getTargetSelectorSuffix=function(a){return a||0===a?("-"+a).replace(/[\s?!@#$%^&*()_=+,.<>'":;\[\]\/|~`{}\\]/g,"-"):""};f.selectorTarget=function(a,b){return(b||"")+"."+g.target+this.getTargetSelectorSuffix(a)};f.selectorTargets=function(a,b){var e=this;a=a||[];return a.length?a.map(function(a){return e.selectorTarget(a,b)}):null};f.selectorLegend=function(a){return"."+g.legendItem+this.getTargetSelectorSuffix(a)};f.selectorLegends=function(a){var b=
this;return a&&a.length?a.map(function(a){return b.selectorLegend(a)}):null};var w=f.isValue=function(a){return a||0===a},J=f.isFunction=function(a){return"function"===typeof a},C=f.isString=function(a){return"string"===typeof a},F=f.isUndefined=function(a){return"undefined"===typeof a},E=f.isDefined=function(a){return"undefined"!==typeof a},X=f.ceil10=function(a){return 10*Math.ceil(a/10)},Z=f.asHalfPixel=function(a){return Math.ceil(a)+.5},T=f.diffDomain=function(a){return a[1]-a[0]},ba=f.isEmpty=
function(a){return!a||C(a)&&0===a.length||"object"===typeof a&&0===Object.keys(a).length},A=f.notEmpty=function(a){return 0<Object.keys(a).length},H=f.getOption=function(a,b,e){return E(a[b])?a[b]:e},ia=f.hasValue=function(a,b){var e=!1;Object.keys(a).forEach(function(f){a[f]===b&&(e=!0)});return e},ja=f.getPathBox=function(a){var b=a.getBoundingClientRect(),e=[a.pathSegList.getItem(0),a.pathSegList.getItem(1)];a=e[0].x;e=Math.min(e[0].y,e[1].y);return{x:a,y:e,width:b.width,height:b.height}};u.focus=
function(a){var b=this.internal,e;a=b.mapToTargetIds(a);e=b.svg.selectAll(b.selectorTargets(a.filter(b.isTargetToShow,b)));this.revert();this.defocus();e.classed(g.focused,!0).classed(g.defocused,!1);b.hasArcType()&&b.expandArc(a);b.toggleFocusLegend(a,!0);b.focusedTargetIds=a;b.defocusedTargetIds=b.defocusedTargetIds.filter(function(b){return 0>a.indexOf(b)})};u.defocus=function(a){var b=this.internal;a=b.mapToTargetIds(a);b.svg.selectAll(b.selectorTargets(a.filter(b.isTargetToShow,b))).classed(g.focused,
!1).classed(g.defocused,!0);b.hasArcType()&&b.unexpandArc(a);b.toggleFocusLegend(a,!1);b.focusedTargetIds=b.focusedTargetIds.filter(function(b){return 0>a.indexOf(b)});b.defocusedTargetIds=a};u.revert=function(a){var b=this.internal;a=b.mapToTargetIds(a);b.svg.selectAll(b.selectorTargets(a)).classed(g.focused,!1).classed(g.defocused,!1);b.hasArcType()&&b.unexpandArc(a);b.config.legend_show&&(b.showLegend(a.filter(b.isLegendToShow.bind(b))),b.legend.selectAll(b.selectorLegends(a)).filter(function(){return b.d3.select(this).classed(g.legendItemFocused)}).classed(g.legendItemFocused,
!1));b.focusedTargetIds=[];b.defocusedTargetIds=[]};u.show=function(a,b){var e=this.internal,f;a=e.mapToTargetIds(a);b=b||{};e.removeHiddenTargetIds(a);f=e.svg.selectAll(e.selectorTargets(a));f.transition().style("opacity",1,"important").call(e.endall,function(){f.style("opacity",null).style("opacity",1)});b.withLegend&&e.showLegend(a);e.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0})};u.hide=function(a,b){var e=this.internal,f;a=e.mapToTargetIds(a);b=b||{};e.addHiddenTargetIds(a);
f=e.svg.selectAll(e.selectorTargets(a));f.transition().style("opacity",0,"important").call(e.endall,function(){f.style("opacity",null).style("opacity",0)});b.withLegend&&e.hideLegend(a);e.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0})};u.toggle=function(a,b){var e=this,f=this.internal;f.mapToTargetIds(a).forEach(function(a){f.isTargetToShow(a)?e.hide(a,b):e.show(a,b)})};u.zoom=function(a){var b=this.internal;a&&(b.isTimeSeries()&&(a=a.map(function(a){return b.parseDate(a)})),
b.brush.extent(a),b.redraw({withUpdateXDomain:!0,withY:b.config.zoom_rescale}),b.config.zoom_onzoom.call(this,b.x.orgDomain()));return b.brush.extent()};u.zoom.enable=function(a){var b=this.internal;b.config.zoom_enabled=a;b.updateAndRedraw()};u.unzoom=function(){var a=this.internal;a.brush.clear().update();a.redraw({withUpdateXDomain:!0})};u.load=function(a){var b=this.internal,e=b.config;a.xs&&b.addXs(a.xs);"classes"in a&&Object.keys(a.classes).forEach(function(b){e.data_classes[b]=a.classes[b]});
"categories"in a&&b.isCategorized()&&(e.axis_x_categories=a.categories);"axes"in a&&Object.keys(a.axes).forEach(function(b){e.data_axes[b]=a.axes[b]});"colors"in a&&Object.keys(a.colors).forEach(function(b){e.data_colors[b]=a.colors[b]});"cacheIds"in a&&b.hasCaches(a.cacheIds)?b.load(b.getCaches(a.cacheIds),a.done):"unload"in a?b.unload(b.mapToTargetIds("boolean"===typeof a.unload&&a.unload?null:a.unload),function(){b.loadFromArgs(a)}):b.loadFromArgs(a)};u.unload=function(a){var b=this.internal;a=
a||{};a instanceof Array?a={ids:a}:"string"===typeof a&&(a={ids:[a]});b.unload(b.mapToTargetIds(a.ids),function(){b.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0});a.done&&a.done()})};u.flow=function(a){var b=this.internal,e,f,g=[],h=b.getMaxDataCount(),m,n=0,t=0,r;if(a.json)f=b.convertJsonToData(a.json,a.keys);else if(a.rows)f=b.convertRowsToData(a.rows);else if(a.columns)f=b.convertColumnsToData(a.columns);else return;e=b.convertDataToTargets(f,!0);b.data.targets.forEach(function(a){var f=
!1,l,h;for(l=0;l<e.length;l++)if(a.id===e[l].id){f=!0;a.values[a.values.length-1]&&(t=a.values[a.values.length-1].index+1);n=e[l].values.length;for(h=0;h<n;h++)e[l].values[h].index=t+h,b.isTimeSeries()||(e[l].values[h].x=t+h);a.values=a.values.concat(e[l].values);e.splice(l,1);break}f||g.push(a.id)});b.data.targets.forEach(function(a){var e,f;for(e=0;e<g.length;e++)if(a.id===g[e])for(t=a.values[a.values.length-1].index+1,f=0;f<n;f++)a.values.push({id:a.id,index:t+f,x:b.isTimeSeries()?b.getOtherTargetX(t+
f):t+f,value:null})});b.data.targets.length&&e.forEach(function(a){var e,f=[];for(e=b.data.targets[0].values[0].index;e<t;e++)f.push({id:a.id,index:e,x:b.isTimeSeries()?b.getOtherTargetX(e):e,value:null});a.values.forEach(function(a){a.index+=t;b.isTimeSeries()||(a.x+=t)});a.values=f.concat(a.values)});b.data.targets=b.data.targets.concat(e);b.getMaxDataCount();m=b.data.targets[0];f=m.values[0];E(a.to)?(n=0,r=b.isTimeSeries()?b.parseDate(a.to):a.to,m.values.forEach(function(a){a.x<r&&n++})):E(a.length)&&
(n=a.length);h?1===h&&b.isTimeSeries()&&(m=(m.values[m.values.length-1].x-f.x)/2,m=[new Date(+f.x-m),new Date(+f.x+m)],b.updateXDomain(null,!0,!0,!1,m)):(m=b.isTimeSeries()?1<m.values.length?m.values[m.values.length-1].x-f.x:f.x-b.getXDomain(b.data.targets)[0]:1,m=[f.x-m,f.x],b.updateXDomain(null,!0,!0,!1,m));b.updateTargets(b.data.targets);b.redraw({flow:{index:f.index,length:n,duration:w(a.duration)?a.duration:b.config.transition_duration,done:a.done,orgDataCount:h},withLegend:!0,withTransition:1<
h,withTrimXDomain:!1,withUpdateXAxis:!0})};f.generateFlow=function(a){var b=this,e=b.config,f=b.d3;return function(){var h=a.targets,m=a.flow,n=a.drawBar,r=a.drawLine,t=a.drawArea,u=a.cx,w=a.cy,x=a.xv,C=a.xForText,F=a.yForText,E=a.duration,B=1,A,G=m.index,H=m.length,J=b.getValueOnIndex(b.data.targets[0].values,G),O=b.getValueOnIndex(b.data.targets[0].values,G+H),B=b.x.domain(),E=m.duration||E,S=m.done||function(){},K=b.generateWait(),Z=b.xgrid||f.selectAll([]),X=b.xgridLines||f.selectAll([]),L=b.mainRegion||
f.selectAll([]),V=b.mainText||f.selectAll([]),ba=b.mainBar||f.selectAll([]),fa=b.mainLine||f.selectAll([]),ga=b.mainArea||f.selectAll([]),ha=b.mainCircle||f.selectAll([]);b.flowing=!0;b.data.targets.forEach(function(a){a.values.splice(0,H)});h=b.updateXDomain(h,!0,!0);b.updateXGrid&&b.updateXGrid(!0);m.orgDataCount?m=1===m.orgDataCount||J.x===O.x?b.x(B[0])-b.x(h[0]):b.isTimeSeries()?b.x(B[0])-b.x(h[0]):b.x(J.x)-b.x(O.x):1!==b.data.targets[0].values.length?m=b.x(B[0])-b.x(h[0]):b.isTimeSeries()?(J=
b.getValueOnIndex(b.data.targets[0].values,0),O=b.getValueOnIndex(b.data.targets[0].values,b.data.targets[0].values.length-1),m=b.x(J.x)-b.x(O.x)):m=T(h)/2;B=T(B)/T(h);A="translate("+m+",0) scale("+B+",1)";b.hideXGridFocus();b.hideTooltip();f.transition().ease("linear").duration(E).each(function(){K.add(b.axes.x.transition().call(b.xAxis));K.add(ba.transition().attr("transform",A));K.add(fa.transition().attr("transform",A));K.add(ga.transition().attr("transform",A));K.add(ha.transition().attr("transform",
A));K.add(V.transition().attr("transform",A));K.add(L.filter(b.isRegionOnX).transition().attr("transform",A));K.add(Z.transition().attr("transform",A));K.add(X.transition().attr("transform",A))}).call(K,function(){var a,f=[],l=[],h=[];if(H){for(a=0;a<H;a++)f.push("."+g.shape+"-"+(G+a)),l.push("."+g.text+"-"+(G+a)),h.push("."+g.eventRect+"-"+(G+a));b.svg.selectAll("."+g.shapes).selectAll(f).remove();b.svg.selectAll("."+g.texts).selectAll(l).remove();b.svg.selectAll("."+g.eventRects).selectAll(h).remove();
b.svg.select("."+g.xgrid).remove()}Z.attr("transform",null).attr(b.xgridAttr);X.attr("transform",null);X.select("line").attr("x1",e.axis_rotated?0:x).attr("x2",e.axis_rotated?b.width:x);X.select("text").attr("x",e.axis_rotated?b.width:0).attr("y",x);ba.attr("transform",null).attr("d",n);fa.attr("transform",null).attr("d",r);ga.attr("transform",null).attr("d",t);ha.attr("transform",null).attr("cx",u).attr("cy",w);V.attr("transform",null).attr("x",C).attr("y",F).style("fill-opacity",b.opacityForText.bind(b));
L.attr("transform",null);L.select("rect").filter(b.isRegionOnX).attr("x",b.regionX.bind(b)).attr("width",b.regionWidth.bind(b));e.interaction_enabled&&b.redrawEventRect();S();b.flowing=!1})}};u.selected=function(a){var b=this.internal,e=b.d3;return e.merge(b.main.selectAll("."+g.shapes+b.getTargetSelectorSuffix(a)).selectAll("."+g.shape).filter(function(){return e.select(this).classed(g.SELECTED)}).map(function(a){return a.map(function(a){a=a.__data__;return a.data?a.data:a})}))};u.select=function(a,
b,e){var f=this.internal,h=f.d3,m=f.config;m.data_selection_enabled&&f.main.selectAll("."+g.shapes).selectAll("."+g.shape).each(function(n,r){var t=h.select(this),u=n.data?n.data.id:n.id,w=f.getToggle(this,n).bind(f),u=m.data_selection_grouped||!a||0<=a.indexOf(u),x=!b||0<=b.indexOf(r),A=t.classed(g.SELECTED);t.classed(g.line)||t.classed(g.area)||(u&&x?m.data_selection_isselectable(n)&&!A&&w(!0,t.classed(g.SELECTED,!0),n,r):E(e)&&e&&A&&w(!1,t.classed(g.SELECTED,!1),n,r))})};u.unselect=function(a,
b){var e=this.internal,f=e.d3,h=e.config;h.data_selection_enabled&&e.main.selectAll("."+g.shapes).selectAll("."+g.shape).each(function(m,n){var r=f.select(this),t=m.data?m.data.id:m.id,u=e.getToggle(this,m).bind(e),t=h.data_selection_grouped||!a||0<=a.indexOf(t),w=!b||0<=b.indexOf(n),x=r.classed(g.SELECTED);r.classed(g.line)||r.classed(g.area)||t&&w&&h.data_selection_isselectable(m)&&x&&u(!1,r.classed(g.SELECTED,!1),m,n)})};u.transform=function(a,b){var e=this.internal,f=0<=["pie","donut"].indexOf(a)?
{withTransform:!0}:null;e.transformTo(b,a,f)};f.transformTo=function(a,b,e){var f=!this.hasArcType();e=e||{withTransitionForAxis:f};this.transiting=e.withTransitionForTransform=!1;this.setTargetType(a,b);this.updateTargets(this.data.targets);this.updateAndRedraw(e)};u.groups=function(a){var b=this.internal,e=b.config;if(F(a))return e.data_groups;e.data_groups=a;b.redraw();return e.data_groups};u.xgrids=function(a){var b=this.internal,e=b.config;if(!a)return e.grid_x_lines;e.grid_x_lines=a;b.redrawWithoutRescale();
return e.grid_x_lines};u.xgrids.add=function(a){return this.xgrids(this.internal.config.grid_x_lines.concat(a?a:[]))};u.xgrids.remove=function(a){this.internal.removeGridLines(a,!0)};u.ygrids=function(a){var b=this.internal,e=b.config;if(!a)return e.grid_y_lines;e.grid_y_lines=a;b.redrawWithoutRescale();return e.grid_y_lines};u.ygrids.add=function(a){return this.ygrids(this.internal.config.grid_y_lines.concat(a?a:[]))};u.ygrids.remove=function(a){this.internal.removeGridLines(a,!1)};u.regions=function(a){var b=
this.internal,e=b.config;if(!a)return e.regions;e.regions=a;b.redrawWithoutRescale();return e.regions};u.regions.add=function(a){var b=this.internal,e=b.config;if(!a)return e.regions;e.regions=e.regions.concat(a);b.redrawWithoutRescale();return e.regions};u.regions.remove=function(a){var b=this.internal,e=b.config,f,h;a=a||{};f=b.getOption(a,"duration",e.transition_duration);h=b.getOption(a,"classes",[g.region]);a=b.main.select("."+g.regions).selectAll(h.map(function(a){return"."+a}));(f?a.transition().duration(f):
a).style("opacity",0).remove();e.regions=e.regions.filter(function(a){var b=!1;if(!a["class"])return!0;a["class"].split(" ").forEach(function(a){0<=h.indexOf(a)&&(b=!0)});return!b});return e.regions};u.data=function(a){var b=this.internal.data.targets;return"undefined"===typeof a?b:b.filter(function(b){return 0<=[].concat(a).indexOf(b.id)})};u.data.shown=function(a){return this.internal.filterTargetsToShow(this.data(a))};u.data.values=function(a){var b=null;a&&(a=this.data(a),b=a[0]?a[0].values.map(function(a){return a.value}):
null);return b};u.data.names=function(a){this.internal.clearLegendItemTextBoxCache();return this.internal.updateDataAttributes("names",a)};u.data.colors=function(a){return this.internal.updateDataAttributes("colors",a)};u.data.axes=function(a){return this.internal.updateDataAttributes("axes",a)};u.category=function(a,b){var e=this.internal,f=e.config;1<arguments.length&&(f.axis_x_categories[a]=b,e.redraw());return f.axis_x_categories[a]};u.categories=function(a){var b=this.internal,e=b.config;if(!arguments.length)return e.axis_x_categories;
e.axis_x_categories=a;b.redraw();return e.axis_x_categories};u.color=function(a){return this.internal.color(a)};u.x=function(a){var b=this.internal;arguments.length&&(b.updateTargetX(b.data.targets,a),b.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0}));return b.data.xs};u.xs=function(a){var b=this.internal;arguments.length&&(b.updateTargetXs(b.data.targets,a),b.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0}));return b.data.xs};u.axis=function(){};u.axis.labels=function(a){var b=this.internal;
arguments.length&&(Object.keys(a).forEach(function(e){b.axis.setLabelText(e,a[e])}),b.axis.updateLabels())};u.axis.max=function(a){var b=this.internal,e=b.config;if(arguments.length)"object"===typeof a?(w(a.x)&&(e.axis_x_max=a.x),w(a.y)&&(e.axis_y_max=a.y),w(a.y2)&&(e.axis_y2_max=a.y2)):e.axis_y_max=e.axis_y2_max=a,b.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0});else return{x:e.axis_x_max,y:e.axis_y_max,y2:e.axis_y2_max}};u.axis.min=function(a){var b=this.internal,e=b.config;if(arguments.length)"object"===
typeof a?(w(a.x)&&(e.axis_x_min=a.x),w(a.y)&&(e.axis_y_min=a.y),w(a.y2)&&(e.axis_y2_min=a.y2)):e.axis_y_min=e.axis_y2_min=a,b.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0});else return{x:e.axis_x_min,y:e.axis_y_min,y2:e.axis_y2_min}};u.axis.range=function(a){if(arguments.length)E(a.max)&&this.axis.max(a.max),E(a.min)&&this.axis.min(a.min);else return{max:this.axis.max(),min:this.axis.min()}};u.legend=function(){};u.legend.show=function(a){var b=this.internal;b.showLegend(b.mapToTargetIds(a));
b.updateAndRedraw({withLegend:!0})};u.legend.hide=function(a){var b=this.internal;b.hideLegend(b.mapToTargetIds(a));b.updateAndRedraw({withLegend:!0})};u.resize=function(a){var b=this.internal.config;b.size_width=a?a.width:null;b.size_height=a?a.height:null;this.flush()};u.flush=function(){this.internal.updateAndRedraw({withLegend:!0,withTransition:!1,withTransitionForTransform:!1})};u.destroy=function(){var a=this.internal;h.clearInterval(a.intervalForObserveInserted);h.onresize=null;a.selectChart.classed("c3",
!1).html("");Object.keys(a).forEach(function(b){a[b]=null});return null};u.tooltip=function(){};u.tooltip.show=function(a){var b=this.internal,e,f;a.mouse&&(f=a.mouse);a.data?b.isMultipleX()?(f=[b.x(a.data.x),b.getYScale(a.data.id)(a.data.value)],e=null):e=w(a.data.index)?a.data.index:b.getIndexByX(a.data.x):"undefined"!==typeof a.x?e=b.getIndexByX(a.x):"undefined"!==typeof a.index&&(e=a.index);b.dispatchEvent("mouseover",e,f);b.dispatchEvent("mousemove",e,f)};u.tooltip.hide=function(){this.internal.dispatchEvent("mouseout",
0)};var O;f.isSafari=function(){var a=h.navigator.userAgent;return 0<=a.indexOf("Safari")&&0>a.indexOf("Chrome")};f.isChrome=function(){return 0<=h.navigator.userAgent.indexOf("Chrome")};Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),e=this,f=function(){},g=function(){return e.apply(this instanceof f?this:a,b.concat(Array.prototype.slice.call(arguments)))};
f.prototype=this.prototype;g.prototype=new f;return g});"function"===typeof define&&define.amd?define("c3",["d3"],B):"undefined"!==typeof exports&&"undefined"!==typeof module?module.exports=B:h.c3=B})(window);function doBreakdown(h){c3.generate({data:{columns:[["Drops"].concat(h)],type:"bar",color:"white"},bindto:"#tabs-3"}).axis.labels({x:"Number of Drops",y:"Turn Played"});$(function(){var h=$("#tabs").tabs();h.find(".ui-tabs-nav").sortable({axis:"x",stop:function(){h.tabs("refresh")}})})};function preload(h){$(h).each(function(){$("<img/>")[0].src=this})}function updateManaCostChosenCards(){rows=$("#cards_chosen tr");for(i=0;i<rows.length;i++)jrows=jQuery(rows[i]),text=jrows.find("[id=card_name]").text(),"undefined"!==typeof card_data[text]&&(jrows.prepend($('<td id="cost">'+card_data[text].cost+"</td>")),$("#no_cards").remove());0==rows.length&&$('<span id="no_cards"><i>no cards chosen yet</i></span>').appendTo($("#cards_chosen"));sortTable()}function updateBreakdown(){}
function sortTable(){var h=document.getElementById("cards_chosen").tBodies[0];if(null!=h){for(var n=[],r=0,m=h.rows.length;r<m;r++){var x=h.rows[r],B=parseFloat(x.cells[0].textContent||x.cells[0].innerText);isNaN(B)||n.push([B,x])}n.sort(function(h,f){return h[0]-f[0]});r=0;for(m=n.length;r<m;r++)h.appendChild(n[r][1]);n=null}};var selected=[null,null,null],userList=null,dat={},img="/images/cards_medium/",img_small="/images/cards_small/",card_back="/images/card_selection_back.png",rarity="none",number_element,old_index=0,selected_index=0,selected_card=0,name_to_id=[],mode="start",d=new Date,arena_id="unknown",pathArray=window.location.pathname.split("/",-1),arena_id=pathArray[3];function createElement(h,n,r){var m=$("<div/>");m.attr({id:n});m.css(r);h.append(m);return m}
function createInputButton(h,n,r,m,x,B){div=$("<div/>");div.attr({id:m,"class":m});div.html();div.css(n);h.prepend(div);h=$('<a href="#">'+r+"</a>").prependTo(div);h.click({id:x,name:m},B);return h}$(document).keydown(function(h){switch(h.which){case 13:for(z=0;3>z;z++)if(null==selected[z]){showClassCards(z);break}}});
function rebindKeys(){$(".search").off("keydown");$(".search").keydown(function(h){switch(h.which){case 38:old_index=selected_index;--selected_index;0>selected_index&&(selected_index=0);highlightElement(selected_index);break;case 40:old_index=selected_index;selected_index+=1;selected_index>=getCurrentListLength()-1&&(selected_index=getCurrentListLength()-1);highlightElement(selected_index);break;case 13:$("li div").get(selected_index).click();break;default:old_index=selected_index,selected_index=
0,highlightElement(selected_index)}})}function resetBG(h){$(".card"+(h+1)).css({"background-image":"url("+card_back+")"})}function initCardClick(h){var n=$(".card"+(h+1));n.click(function(){showClassCards(h)});n.html("");resetBG(h)}function initCardClicks(){for(var h=0;3>h;h++)initCardClick(h)}
function loadCardSelection(){card_selected=0;initCardClicks();rebindKeys();$(".search").hide();number_element=createElement($("#top_bar"),"card_number",{});updateNumber(card_number);cancel_link=createElement($("#top_bar"),"undo_last_card",{});cancel_link.html('<a href="#" onclick="undoLastCard(); return false;">undo</a>');$(document).click(function(h){$(".search").focus();rebindKeys()});$(document).keydown(function(h){8!==h.which||$(h.target).is("input, textarea")||h.preventDefault()})}
function confirmCards(){mode="waiting_for_card";selected_card=0;old_index=selected_index;selected_index=0;var h="/draft/card_choice/"+selected[0]+"/"+selected[1]+"/"+selected[2]+"/"+arena_id,n=n||[];n.push(["_trackPageview",h]);$.get(h,function(h){loadChosenCards(h)})}function changeBg(h){h=getCardElement(h);h.css({background:"rgba(0,0,0,.75)"});return h}
function showClassCards(h){old_index=selected_index;selected_index=0;selected_card=h;for(var n=0;3>n;n++)h!=n&&null==selected[n]&&resetBG(n);var n=changeBg(h),r=$("#cards");r.css({display:"block","z-index":9999});r.addClass("capital");n.append(r);rebuildList();$(".search").focus();highlightElement(selected_index);n=$(".name").button();$(".list li").mousemove(function(h){name=$(this).text();old_index=selected_index});n.click(function(m){m.preventDefault();m.stopPropagation();m=$(this);card_picked(h,
m.text())})}function card_picked(h,n){$("#cards").css({display:"none"});layoutCardChosen(n,h);userList.clear();$(".search").hide();$("body").append($("#cards"));var r=0;for(z=0;3>z;z++)if(null==selected[z]){r=z;break}0==r&&confirmCards()}function setMessageText(h,n){return $('<p id="top_message_'+h+'">'+n+"</p>")}function updateNumber(h){$("#card_number").text(h+"/30")}
function highlightElement(h){var n=$("#cards");4<h&&n.scrollTop(35*(h-5));$("li div:eq("+old_index+")").removeClass("ui-state-hover");$("li div:eq("+h+")").addClass("ui-state-hover")}function getCurrentListLength(){return $("li div").length}
function filterList(){if("none"!=rarity){var h=[];for(i=0;i<userList.items.length;i++){var n=userList.items[i],r=n._values,m=1;"unknown"!=rarity&&("basic"==rarity||"free"==rarity||"common"==rarity?"basic"!=r.rarity&&"free"!=r.rarity&&"common"!=r.rarity&&(m=0):r.rarity!=rarity&&(m=0));for(j=0;j<selected.length;j++)null!=selected[j]&&r.name==selected[j]&&(m=0);m&&h.push(n)}userList.items=h}}
function rebuildList(){null!=userList&&userList.clear();userList=new List("cards",{valueNames:["name"],item:'<li><div class="name"></div></li>'},cards);userList.on("searchComplete",function(){highlightElement(selected_index)});filterList();userList.page=1E3;userList.sort("name");$(".search").val("");$(".search").show().focus();rebindKeys()}function removeUndo(){removeElement("#undo")}function removeElement(h){for(;$(h).length;)for(var n=0;n<$(h).length;n++)$(h).remove()}
function removeConfirmChoices(){removeElement("#ipicked")}function removeHighlight(){$("div#highlight").hide()}function removeSynergies(){for(s=0;3>s;s++)$("#outer-synergies"+s).remove()}function makeOdometer(h){h=$('<div class="odometer card_'+(h+1)+'_meter">0</div>');od=new Odometer({el:h.get(0),value:0,format:"",theme:"minimal"});return h}function updateOdometer(h,n){var r=$(".card_"+(h+1)+"_meter");r.show();r.text(0);r.text(parseInt(n))}
function removeOdo(){$("#odo").remove();$("#odo").remove();$("#odo").remove()}function getCardElement(h){return $(".card"+(h+1))}
function undoCardChoice(h){removeHighlight();removeConfirmChoices();getCardElement(h);selected[h]=null;null==selected[0]&&null==selected[1]&&null==selected[2]&&(rarity="none");removeElement("#best");removeElement(".waiting");$("#message_panel").hide();initCardClick(h);removeOdo();removeSynergies();null!=selected[0]&&addWaiting(0);null!=selected[1]&&addWaiting(1);null!=selected[2]&&addWaiting(2)}function getCardFile(h){return img+card_ids[h]+".png"}
function addWaiting(h){h=getCardElement(h);var n=$('<div class="waiting"/>');n.text("Waiting for all cards to be picked...");n.appendTo(h);n.addClass(class_name)}
function layoutCardChosen(h,n){"undefined"===typeof card_data[h]&&(alert("Class Mismatch! "+class_name+' does not have the card "'+h+'"'),document.location.href="/home");var r=getCardElement(n);r.off("click");selected[n]=h;rarity=card_rarity[h];var m=$('<div id="card_img_'+n+'"/>');m.css({"background-image":'url("'+getCardFile(h)+'")'});m.appendTo(r);m.addClass("type_"+card_data[h].type);m.addClass(class_name);m=$('<div class="card_name_label"/>');m.text(h);m.appendTo(r);m.addClass("capital");m.addClass(class_name);
addWaiting(n);createInputButton(r,{},'<img src="/images/cancel.png"/>',"undo",n,function(h){$(this).remove();undoCardChoice(n);h.stopPropagation()});return r}function loadChosenCards(h){$(".waiting").remove();buildConfirmChoices(arena_id);buildScoreUI(h);buildSynergyUI(h);$("#message_panel").text(h.message);$("#message_panel").show();$("#message_panel").addClass(class_name)}
function buildConfirmChoices(h){for(j=0;j<selected.length;j++)createInputButton($(".card"+(j+1)),{},"I Picked This Card","ipicked",j,function(h){confirmCardChoice(h)}).addClass(class_name)}
function buildScoreUI(h){for(c=0;3>c;c++){var n=$('<span id="odo"></span>');n.appendTo(getCardElement(c));makeOdometer(c).hide().appendTo(n);if(selected[c]==h.best_card){getCardElement(c).find("#best").remove();var r=$('<span class="gold" id="best">Yes!</span>');r.appendTo(getCardElement(c));n.addClass("best_score")}else r=$('<span class="bronze" id="best">No</span>'),r.appendTo(getCardElement(c))}n=-100;for(j=0;j<selected.length;j++)name_to_id[selected[j]]=j,r=h.scores[selected[j]],r>n&&(n=r),updateOdometer(j,
r)}function confirmCardByName(h,n){for(i=0;i<selected.length;i++)if(selected[i]==h){confirmCard(i,n);break}}function finishConfirm(h){card_number+=1;30<=card_number?($('[class^="card"]').hide(),document.location.href="/draft/view_completed_run/"+arena_id):(updateChosenCardsTab(h),removeConfirmChoices(),updateNumber(card_number),initCardClicks(),selected=[],rarity="none",removeUndo(),removeHighlight(),$("#message_panel").hide())}
function undoLastCard(){if(0!=card_number&&window.confirm("Are you sure you want to undo the last card choice? There is no redo.")){var h="/draft/arena_action/undo_last_card_"+arena_id,n=n||[];n.push(["_trackPageview",h]);$.get(h,function(h){0!=card_number&&(--card_number,removeConfirmChoices(),removeElement(".waiting"),updateNumber(card_number),initCardClicks(),selected=[],removeUndo(),removeHighlight(),updateChosenCardsTab(h))})}}
function confirmCard(h,n){if(n)finishConfirm(n);else{var r="/draft/confirm_card_choice/"+selected[h]+"/"+arena_id,m=m||[];m.push(["_trackPageview",r]);$.get(r,function(h){finishConfirm(h)})}}function confirmCardChoice(h){h.preventDefault();h.stopPropagation();confirmCard(h.data.id)}
function updateChosenCardsTab(h){var n=Object.keys(h),r,m=n.length;n.sort();$("#cards_chosen").html("");for(r=0;r<m;r++){k=n[r];var x=$('<tr><td id="card_name"><span class="capital">'+k+'</span></td><td id="card_count">'+h[k]+"</td></tr>");$("#cards_chosen").append(x)}updateManaCostChosenCards()}function createSynergiesDiv(h){var n=$('<div id="synergies'+h+'" class="synergy_list">');h=$('<div class="outer-syn" id="outer-synergies'+h+'"><h3>Synergies</h3></div>');n.appendTo(h);return h}
function buildSynergyUI(h,n){for(myvar in h.synergy){synergies=createSynergiesDiv(name_to_id[myvar]);var r=0;for(syn in h.synergy[myvar]){var m=h.synergy[myvar][syn].card_name,r=h.synergy[myvar][syn].reason,x=$('<div class="item"></div>');x.appendTo(synergies.find('[id^="synergies"]'));m=$('<a href="#">'+m+"</a>");m.appendTo(x);m.prop("title",r);m.addClass("capital");r=1}r||$("<p><i>None found.</i>").appendTo(synergies.find('[id^="synergies"]'));card_pane=$(".card"+(name_to_id[myvar]+1));synergies.appendTo(card_pane)}}
;
